parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"L3xk":[function(require,module,exports) {
var define;
var e;parcelRequire=function(t,i,r,n){var a,s="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(e,r){if(!i[e]){if(!t[e]){var n="function"==typeof parcelRequire&&parcelRequire;if(!r&&n)return n(e,!0);if(s)return s(e,!0);if(o&&"string"==typeof e)return o(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}c.resolve=function(i){return t[e][1][i]||i},c.cache={};var l=i[e]=new u.Module(e);t[e][0].call(l.exports,c,l,l.exports,this)}return i[e].exports;function c(e){return u(c.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=t,u.cache=i,u.parent=s,u.register=function(e,i){t[e]=[function(e,t){t.exports=i},{}]};for(var l=0;l<r.length;l++)try{u(r[l])}catch(t){a||(a=t)}if(r.length){var c=u(r[r.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof e&&e.amd&&e(function(){return c})}if(parcelRequire=u,a)throw a;return u}({YKZR:[function(e,t,i){parcelRequire=function(r,n,a,s){var o,u="function"==typeof parcelRequire&&parcelRequire,l="function"==typeof e&&e;function c(e,t){if(!n[e]){if(!r[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!t&&i)return i(e,!0);if(u)return u(e,!0);if(l&&"string"==typeof e)return l(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}o.resolve=function(t){return r[e][1][t]||t},o.cache={};var s=n[e]=new c.Module(e);r[e][0].call(s.exports,o,s,s.exports,this)}return n[e].exports;function o(e){return c(o.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=r,c.cache=n,c.parent=u,c.register=function(e,t){r[e]=[function(e,i){i.exports=t},{}]};for(var h=0;h<a.length;h++)try{c(a[h])}catch(r){o||(o=r)}if(a.length){var m=c(a[a.length-1]);"object"==typeof i&&void 0!==t&&(t.exports=m)}if(parcelRequire=c,o)throw o;return c}({Spxq:[function(e,t,i){"use strict";var r,n,a;Object.defineProperty(i,"__esModule",{value:!0}),i.y=i.x=i.Y=void 0,i.Y=r,function(e){e[e.RED=.2126]="RED",e[e.GREEN=.7152]="GREEN",e[e.BLUE=.0722]="BLUE",e[e.WHITE=1]="WHITE"}(r||(i.Y=r={})),i.x=n,function(e){e[e.RED=.64]="RED",e[e.GREEN=.3]="GREEN",e[e.BLUE=.15]="BLUE",e[e.WHITE=.3127]="WHITE"}(n||(i.x=n={})),i.y=a,function(e){e[e.RED=.33]="RED",e[e.GREEN=.6]="GREEN",e[e.BLUE=.06]="BLUE",e[e.WHITE=.329]="WHITE"}(a||(i.y=a={}))},{}],TlpJ:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.bt709=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=function(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return function(){return e},e}();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}(e("./bt709"));i.bt709=r},{"./bt709":"Spxq"}],pYSN:[function(e,t,i){"use strict";function r(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}Object.defineProperty(i,"__esModule",{value:!0}),i.rgb2xyz=function(e,t,i){return{x:.4124*(e=r(e/255))+.3576*(t=r(t/255))+.1805*(i=r(i/255)),y:.2126*e+.7152*t+.0722*i,z:.0193*e+.1192*t+.9505*i}}},{}],b3mL:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.degrees2radians=function(e){return e*(Math.PI/180)},i.max3=function(e,t,i){let r=e;return r<t&&(r=t),r<i&&(r=i),r},i.min3=function(e,t,i){let r=e;return r>t&&(r=t),r>i&&(r=i),r},i.intInRange=function(e,t,i){return e>i&&(e=i),e<t&&(e=t),0|e},i.inRange0to255Rounded=function(e){return(e=Math.round(e))>255?e=255:e<0&&(e=0),e},i.inRange0to255=function(e){return e>255?e=255:e<0&&(e=0),e},i.stableSort=function(e,t){const i=typeof e[0];let r;if("number"===i||"string"===i){const i=Object.create(null);for(let t=0,r=e.length;t<r;t++){const r=e[t];i[r]||0===i[r]||(i[r]=t)}r=e.sort(function(e,r){return t(e,r)||i[e]-i[r]})}else{const i=e.slice(0);r=e.sort(function(e,r){return t(e,r)||i.indexOf(e)-i.indexOf(r)})}return r}},{}],RhPC:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.rgb2hsl=function(e,t,i){const n=(0,r.min3)(e,t,i),a=(0,r.max3)(e,t,i),s=a-n,o=(n+a)/510;let u=0;o>0&&o<1&&(u=s/(o<.5?a+n:510-a-n));let l=0;return s>0&&(l=a===e?(t-i)/s:a===t?2+(i-e)/s:4+(e-t)/s,(l*=60)<0&&(l+=360)),{h:l,s:u,l:o}};var r=e("../utils/arithmetic")},{"../utils/arithmetic":"b3mL"}],dYwZ:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.xyz2lab=function(e,t,i){if(e=s(e/r),t=s(t/n),i=s(i/a),116*t-16<0)throw new Error("xxx");return{L:Math.max(0,116*t-16),a:500*(e-t),b:200*(t-i)}};const r=.95047,n=1,a=1.08883;function s(e){return e>.008856?Math.pow(e,1/3):7.787*e+16/116}},{}],mK7q:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.rgb2lab=function(e,t,i){const a=(0,r.rgb2xyz)(e,t,i);return(0,n.xyz2lab)(a.x,a.y,a.z)};var r=e("./rgb2xyz"),n=e("./xyz2lab")},{"./rgb2xyz":"pYSN","./xyz2lab":"dYwZ"}],OfSb:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.lab2xyz=function(e,t,i){const o=(e+16)/116,u=o-i/200;return{x:r*s(t/500+o),y:n*s(o),z:a*s(u)}};const r=.95047,n=1,a=1.08883;function s(e){return e>.206893034?Math.pow(e,3):(e-16/116)/7.787}},{}],RJ9n:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.xyz2rgb=function(e,t,i){const a=n(3.2406*e+-1.5372*t+-.4986*i),s=n(-.9689*e+1.8758*t+.0415*i),o=n(.0557*e+-.204*t+1.057*i);return{r:(0,r.inRange0to255Rounded)(255*a),g:(0,r.inRange0to255Rounded)(255*s),b:(0,r.inRange0to255Rounded)(255*o)}};var r=e("../utils/arithmetic");function n(e){return e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e}},{"../utils/arithmetic":"b3mL"}],RhbY:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.lab2rgb=function(e,t,i){const a=(0,r.lab2xyz)(e,t,i);return(0,n.xyz2rgb)(a.x,a.y,a.z)};var r=e("./lab2xyz"),n=e("./xyz2rgb")},{"./lab2xyz":"OfSb","./xyz2rgb":"RJ9n"}],T7GD:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"rgb2xyz",{enumerable:!0,get:function(){return r.rgb2xyz}}),Object.defineProperty(i,"rgb2hsl",{enumerable:!0,get:function(){return n.rgb2hsl}}),Object.defineProperty(i,"rgb2lab",{enumerable:!0,get:function(){return a.rgb2lab}}),Object.defineProperty(i,"lab2xyz",{enumerable:!0,get:function(){return s.lab2xyz}}),Object.defineProperty(i,"lab2rgb",{enumerable:!0,get:function(){return o.lab2rgb}}),Object.defineProperty(i,"xyz2lab",{enumerable:!0,get:function(){return u.xyz2lab}}),Object.defineProperty(i,"xyz2rgb",{enumerable:!0,get:function(){return l.xyz2rgb}});var r=e("./rgb2xyz"),n=e("./rgb2hsl"),a=e("./rgb2lab"),s=e("./lab2xyz"),o=e("./lab2rgb"),u=e("./xyz2lab"),l=e("./xyz2rgb")},{"./rgb2xyz":"pYSN","./rgb2hsl":"RhPC","./rgb2lab":"mK7q","./lab2xyz":"OfSb","./lab2rgb":"RhbY","./xyz2lab":"dYwZ","./xyz2rgb":"RJ9n"}],rtya:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.AbstractDistanceCalculator=void 0,i.AbstractDistanceCalculator=class{constructor(){this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(e,t,i,r){this._whitePoint={r:e>0?255/e:0,g:t>0?255/t:0,b:i>0?255/i:0,a:r>0?255/r:0},this._maxDistance=this.calculateRaw(e,t,i,r,0,0,0,0)}calculateNormalized(e,t){return this.calculateRaw(e.r,e.g,e.b,e.a,t.r,t.g,t.b,t.a)/this._maxDistance}}},{}],MS9V:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.CIE94GraphicArts=i.CIE94Textiles=i.AbstractCIE94=void 0;var r=e("./distanceCalculator"),n=e("../conversion/rgb2lab"),a=e("../utils/arithmetic");class s extends r.AbstractDistanceCalculator{calculateRaw(e,t,i,r,s,o,u,l){const c=(0,n.rgb2lab)((0,a.inRange0to255)(e*this._whitePoint.r),(0,a.inRange0to255)(t*this._whitePoint.g),(0,a.inRange0to255)(i*this._whitePoint.b)),h=(0,n.rgb2lab)((0,a.inRange0to255)(s*this._whitePoint.r),(0,a.inRange0to255)(o*this._whitePoint.g),(0,a.inRange0to255)(u*this._whitePoint.b)),m=c.L-h.L,_=c.a-h.a,d=c.b-h.b,f=Math.sqrt(c.a*c.a+c.b*c.b),p=f-Math.sqrt(h.a*h.a+h.b*h.b);let g=_*_+d*d-p*p;g=g<0?0:Math.sqrt(g);const b=(l-r)*this._whitePoint.a*this._kA;return Math.sqrt(Math.pow(m/this._Kl,2)+Math.pow(p/(1+this._K1*f),2)+Math.pow(g/(1+this._K2*f),2)+Math.pow(b,2))}}i.AbstractCIE94=s,i.CIE94Textiles=class extends s{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},i.CIE94GraphicArts=class extends s{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}}},{"./distanceCalculator":"rtya","../conversion/rgb2lab":"mK7q","../utils/arithmetic":"b3mL"}],oVGY:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.CIEDE2000=void 0;var r=e("./distanceCalculator"),n=e("../conversion/rgb2lab"),a=e("../utils/arithmetic");class s extends r.AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(e,t){const i=Math.atan2(e,t);return i>=0?i:i+s._deg360InRad}static _calculateRT(e,t){const i=Math.pow(t,7),r=2*Math.sqrt(i/(i+s._pow25to7)),n=s._deg30InRad*Math.exp(-Math.pow((e-s._deg275InRad)/s._deg25InRad,2));return-Math.sin(2*n)*r}static _calculateT(e){return 1-.17*Math.cos(e-s._deg30InRad)+.24*Math.cos(2*e)+.32*Math.cos(3*e+s._deg6InRad)-.2*Math.cos(4*e-s._deg63InRad)}static _calculate_ahp(e,t,i,r){const n=i+r;return 0===e?n:t<=s._deg180InRad?n/2:n<s._deg360InRad?(n+s._deg360InRad)/2:(n-s._deg360InRad)/2}static _calculate_dHp(e,t,i,r){let n;return n=0===e?0:t<=s._deg180InRad?i-r:i<=r?i-r+s._deg360InRad:i-r-s._deg360InRad,2*Math.sqrt(e)*Math.sin(n/2)}calculateRaw(e,t,i,r,o,u,l,c){const h=(0,n.rgb2lab)((0,a.inRange0to255)(e*this._whitePoint.r),(0,a.inRange0to255)(t*this._whitePoint.g),(0,a.inRange0to255)(i*this._whitePoint.b)),m=(0,n.rgb2lab)((0,a.inRange0to255)(o*this._whitePoint.r),(0,a.inRange0to255)(u*this._whitePoint.g),(0,a.inRange0to255)(l*this._whitePoint.b)),_=(c-r)*this._whitePoint.a*s._kA,d=this.calculateRawInLab(h,m);return Math.sqrt(d+_*_)}calculateRawInLab(e,t){const i=e.L,r=e.a,n=e.b,a=t.L,o=t.a,u=t.b,l=Math.sqrt(r*r+n*n),c=Math.sqrt(o*o+u*u),h=Math.pow((l+c)/2,7),m=.5*(1-Math.sqrt(h/(h+s._pow25to7))),_=(1+m)*r,d=(1+m)*o,f=Math.sqrt(_*_+n*n),p=Math.sqrt(d*d+u*u),g=f*p,b=s._calculatehp(n,_),M=s._calculatehp(u,d),y=Math.abs(b-M),x=a-i,w=p-f,P=s._calculate_dHp(g,y,M,b),v=s._calculate_ahp(g,y,b,M),S=s._calculateT(v),z=(f+p)/2,A=Math.pow((i+a)/2-50,2),E=1+.015*A/Math.sqrt(20+A),R=1+.045*z,k=1+.015*S*z,O=s._calculateRT(v,z),C=x/E,j=w/R,B=P/k;return Math.pow(C,2)+Math.pow(j,2)+Math.pow(B,2)+O*j*B}}i.CIEDE2000=s,s._kA=25/255,s._pow25to7=Math.pow(25,7),s._deg360InRad=(0,a.degrees2radians)(360),s._deg180InRad=(0,a.degrees2radians)(180),s._deg30InRad=(0,a.degrees2radians)(30),s._deg6InRad=(0,a.degrees2radians)(6),s._deg63InRad=(0,a.degrees2radians)(63),s._deg275InRad=(0,a.degrees2radians)(275),s._deg25InRad=(0,a.degrees2radians)(25)},{"./distanceCalculator":"rtya","../conversion/rgb2lab":"mK7q","../utils/arithmetic":"b3mL"}],FZPz:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.CMetric=void 0;var r=e("./distanceCalculator");i.CMetric=class extends r.AbstractDistanceCalculator{calculateRaw(e,t,i,r,n,a,s,o){const u=(e+n)/2*this._whitePoint.r,l=(e-n)*this._whitePoint.r,c=(t-a)*this._whitePoint.g,h=(i-s)*this._whitePoint.b,m=((512+u)*l*l>>8)+4*c*c+((767-u)*h*h>>8),_=(o-r)*this._whitePoint.a;return Math.sqrt(m+_*_)}_setDefaults(){}}},{"./distanceCalculator":"rtya"}],Nul3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.EuclideanBT709NoAlpha=i.EuclideanBT709=i.Euclidean=i.AbstractEuclidean=void 0;var r=e("./distanceCalculator"),n=e("../constants/bt709");class a extends r.AbstractDistanceCalculator{calculateRaw(e,t,i,r,n,a,s,o){const u=n-e,l=a-t,c=s-i,h=o-r;return Math.sqrt(this._kR*u*u+this._kG*l*l+this._kB*c*c+this._kA*h*h)}}i.AbstractEuclidean=a,i.Euclidean=class extends a{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},i.EuclideanBT709=class extends a{_setDefaults(){this._kR=n.Y.RED,this._kG=n.Y.GREEN,this._kB=n.Y.BLUE,this._kA=1}},i.EuclideanBT709NoAlpha=class extends a{_setDefaults(){this._kR=n.Y.RED,this._kG=n.Y.GREEN,this._kB=n.Y.BLUE,this._kA=0}}},{"./distanceCalculator":"rtya","../constants/bt709":"Spxq"}],rGhK:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ManhattanBT709=i.ManhattanNommyde=i.Manhattan=i.AbstractManhattan=void 0;var r=e("./distanceCalculator"),n=e("../constants/bt709");class a extends r.AbstractDistanceCalculator{calculateRaw(e,t,i,r,n,a,s,o){let u=n-e,l=a-t,c=s-i,h=o-r;return u<0&&(u=0-u),l<0&&(l=0-l),c<0&&(c=0-c),h<0&&(h=0-h),this._kR*u+this._kG*l+this._kB*c+this._kA*h}}i.AbstractManhattan=a,i.Manhattan=class extends a{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},i.ManhattanNommyde=class extends a{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},i.ManhattanBT709=class extends a{_setDefaults(){this._kR=n.Y.RED,this._kG=n.Y.GREEN,this._kB=n.Y.BLUE,this._kA=1}}},{"./distanceCalculator":"rtya","../constants/bt709":"Spxq"}],VUdH:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PNGQuant=void 0;var r=e("./distanceCalculator");i.PNGQuant=class extends r.AbstractDistanceCalculator{calculateRaw(e,t,i,r,n,a,s,o){const u=(o-r)*this._whitePoint.a;return this._colordifferenceCh(e*this._whitePoint.r,n*this._whitePoint.r,u)+this._colordifferenceCh(t*this._whitePoint.g,a*this._whitePoint.g,u)+this._colordifferenceCh(i*this._whitePoint.b,s*this._whitePoint.b,u)}_colordifferenceCh(e,t,i){const r=e-t,n=r+i;return r*r+n*n}_setDefaults(){}}},{"./distanceCalculator":"rtya"}],a183:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AbstractDistanceCalculator",{enumerable:!0,get:function(){return r.AbstractDistanceCalculator}}),Object.defineProperty(i,"CIE94Textiles",{enumerable:!0,get:function(){return n.CIE94Textiles}}),Object.defineProperty(i,"CIE94GraphicArts",{enumerable:!0,get:function(){return n.CIE94GraphicArts}}),Object.defineProperty(i,"CIEDE2000",{enumerable:!0,get:function(){return a.CIEDE2000}}),Object.defineProperty(i,"CMetric",{enumerable:!0,get:function(){return s.CMetric}}),Object.defineProperty(i,"AbstractEuclidean",{enumerable:!0,get:function(){return o.AbstractEuclidean}}),Object.defineProperty(i,"Euclidean",{enumerable:!0,get:function(){return o.Euclidean}}),Object.defineProperty(i,"EuclideanBT709NoAlpha",{enumerable:!0,get:function(){return o.EuclideanBT709NoAlpha}}),Object.defineProperty(i,"EuclideanBT709",{enumerable:!0,get:function(){return o.EuclideanBT709}}),Object.defineProperty(i,"AbstractManhattan",{enumerable:!0,get:function(){return u.AbstractManhattan}}),Object.defineProperty(i,"Manhattan",{enumerable:!0,get:function(){return u.Manhattan}}),Object.defineProperty(i,"ManhattanBT709",{enumerable:!0,get:function(){return u.ManhattanBT709}}),Object.defineProperty(i,"ManhattanNommyde",{enumerable:!0,get:function(){return u.ManhattanNommyde}}),Object.defineProperty(i,"PNGQuant",{enumerable:!0,get:function(){return l.PNGQuant}});var r=e("./distanceCalculator"),n=e("./cie94"),a=e("./ciede2000"),s=e("./cmetric"),o=e("./euclidean"),u=e("./manhattan"),l=e("./pngQuant")},{"./distanceCalculator":"rtya","./cie94":"MS9V","./ciede2000":"oVGY","./cmetric":"FZPz","./euclidean":"Nul3","./manhattan":"rGhK","./pngQuant":"VUdH"}],gm7f:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.AbstractPaletteQuantizer=void 0,i.AbstractPaletteQuantizer=class{quantizeSync(){for(const e of this.quantize())if(e.palette)return e.palette;throw new Error("unreachable")}}},{}],AzZH:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Point=void 0;var r=e("../constants/bt709");class n{static createByQuadruplet(e){const t=new n;return t.r=0|e[0],t.g=0|e[1],t.b=0|e[2],t.a=0|e[3],t._loadUINT32(),t._loadQuadruplet(),t}static createByRGBA(e,t,i,r){const a=new n;return a.r=0|e,a.g=0|t,a.b=0|i,a.a=0|r,a._loadUINT32(),a._loadQuadruplet(),a}static createByUint32(e){const t=new n;return t.uint32=e>>>0,t._loadRGBA(),t._loadQuadruplet(),t}constructor(){this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}from(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.uint32=e.uint32,this.rgba[0]=e.r,this.rgba[1]=e.g,this.rgba[2]=e.b,this.rgba[3]=e.a}getLuminosity(e){let t=this.r,i=this.g,n=this.b;return e&&(t=Math.min(255,255-this.a+this.a*t/255),i=Math.min(255,255-this.a+this.a*i/255),n=Math.min(255,255-this.a+this.a*n/255)),t*r.Y.RED+i*r.Y.GREEN+n*r.Y.BLUE}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}}i.Point=n},{"../constants/bt709":"Spxq"}],zKNk:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PointContainer=void 0;var r=e("./point");class n{constructor(){this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(e){this._width=e}setHeight(e){this._height=e}getPointArray(){return this._pointArray}clone(){const e=new n;e._width=this._width,e._height=this._height;for(let t=0,i=this._pointArray.length;t<i;t++)e._pointArray[t]=r.Point.createByUint32(0|this._pointArray[t].uint32);return e}toUint32Array(){const e=this._pointArray.length,t=new Uint32Array(e);for(let i=0;i<e;i++)t[i]=this._pointArray[i].uint32;return t}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(e){const t=e.naturalWidth,i=e.naturalHeight,r=document.createElement("canvas");return r.width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,t,i,0,0,t,i),n.fromHTMLCanvasElement(r)}static fromHTMLCanvasElement(e){const t=e.width,i=e.height,r=e.getContext("2d").getImageData(0,0,t,i);return n.fromImageData(r)}static fromImageData(e){const t=e.width,i=e.height;return n.fromUint8Array(e.data,t,i)}static fromUint8Array(e,t,i){switch(Object.prototype.toString.call(e)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:e=new Uint8Array(e)}const r=new Uint32Array(e.buffer);return n.fromUint32Array(r,t,i)}static fromUint32Array(e,t,i){const a=new n;a._width=t,a._height=i;for(let n=0,s=e.length;n<s;n++)a._pointArray[n]=r.Point.createByUint32(0|e[n]);return a}static fromBuffer(e,t,i){const r=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/Uint32Array.BYTES_PER_ELEMENT);return n.fromUint32Array(r,t,i)}}i.PointContainer=n},{"./point":"AzZH"}],KCSi:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.hueGroup=a,i.Palette=void 0;var r=e("./pointContainer"),n=e("../conversion/rgb2hsl");function a(e,t){const i=360/t;for(let r=1,n=i-i/2;r<t;r++,n+=i)if(e>=n&&e<n+i)return r;return 0}i.Palette=class{constructor(){this._pointArray=[],this._i32idx={},this._pointContainer=new r.PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(e){this._pointArray.push(e),this._pointContainer.setWidth(this._pointArray.length)}has(e){for(let t=this._pointArray.length-1;t>=0;t--)if(e.uint32===this._pointArray[t].uint32)return!0;return!1}getNearestColor(e,t){return this._pointArray[0|this._getNearestIndex(e,t)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(e){return"number"==typeof this._i32idx[e]?this._i32idx[e]:-1}_getNearestIndex(e,t){let i=this._nearestPointFromCache(""+t.uint32);if(i>=0)return i;let r=Number.MAX_VALUE;i=0;for(let n=0,a=this._pointArray.length;n<a;n++){const a=this._pointArray[n],s=e.calculateRaw(t.r,t.g,t.b,t.a,a.r,a.g,a.b,a.a);s<r&&(r=s,i=n)}return this._i32idx[t.uint32]=i,i}sort(){this._i32idx={},this._pointArray.sort((e,t)=>{const i=(0,n.rgb2hsl)(e.r,e.g,e.b),r=(0,n.rgb2hsl)(t.r,t.g,t.b),s=e.r===e.g&&e.g===e.b?0:1+a(i.h,10),o=(t.r===t.g&&t.g===t.b?0:1+a(r.h,10))-s;if(o)return-o;const u=e.getLuminosity(!0),l=t.getLuminosity(!0);if(l-u!=0)return l-u;const c=(100*r.s|0)-(100*i.s|0);return c?-c:0})}}},{"./pointContainer":"zKNk","../conversion/rgb2hsl":"RhPC"}],sduU:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.HueStatistics=void 0;var r=e("../conversion/rgb2hsl"),n=e("./palette");class a{constructor(){this.num=0,this.cols=[]}}i.HueStatistics=class{constructor(e,t){this._numGroups=e,this._minCols=t,this._stats=[];for(let i=0;i<=e;i++)this._stats[i]=new a;this._groupsFull=0}check(e){this._groupsFull===this._numGroups+1&&(this.check=function(){});const t=255&e,i=e>>>8&255,a=e>>>16&255,s=t===i&&i===a?0:1+(0,n.hueGroup)((0,r.rgb2hsl)(t,i,a).h,this._numGroups),o=this._stats[s],u=this._minCols;o.num++,o.num>u||(o.num===u&&this._groupsFull++,o.num<=u&&this._stats[s].cols.push(e))}injectIntoDictionary(e){for(let t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach(t=>{e[t]?e[t]++:e[t]=1})}injectIntoArray(e){for(let t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach(t=>{-1===e.indexOf(t)&&e.push(t)})}}},{"../conversion/rgb2hsl":"RhPC","./palette":"KCSi"}],ywMQ:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ProgressTracker=void 0;class r{constructor(e,t){this._range=e,this._progressRange=t,this._step=Math.max(1,this._range/(r.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(e){return e-this._last>=this._step&&(this._last=e,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}}i.ProgressTracker=r,r.steps=100},{}],MRhM:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"HueStatistics",{enumerable:!0,get:function(){return n.HueStatistics}}),Object.defineProperty(i,"Palette",{enumerable:!0,get:function(){return a.Palette}}),Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return s.Point}}),Object.defineProperty(i,"PointContainer",{enumerable:!0,get:function(){return o.PointContainer}}),Object.defineProperty(i,"ProgressTracker",{enumerable:!0,get:function(){return u.ProgressTracker}}),i.arithmetic=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=function(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return function(){return e},e}();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}(e("./arithmetic"));i.arithmetic=r;var n=e("./hueStatistics"),a=e("./palette"),s=e("./point"),o=e("./pointContainer"),u=e("./progressTracker")},{"./arithmetic":"b3mL","./hueStatistics":"sduU","./palette":"KCSi","./point":"AzZH","./pointContainer":"zKNk","./progressTracker":"ywMQ"}],TSYH:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NeuQuant=void 0;var r=e("../../utils/palette"),n=e("../../utils/point"),a=e("../paletteQuantizer"),s=e("../../utils");const o=3;class u{constructor(e){this.r=this.g=this.b=this.a=e}toPoint(){return n.Point.createByRGBA(this.r>>o,this.g>>o,this.b>>o,this.a>>o)}subtract(e,t,i,r){this.r-=0|e,this.g-=0|t,this.b-=0|i,this.a-=0|r}}class l extends a.AbstractPaletteQuantizer{constructor(e,t=256){super(),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=t,this._distance.setWhitePoint(255<<o,255<<o,255<<o,255<<o)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new u((e<<o+8)/this._networkSize|0),this._freq[e]=l._initialBias/this._networkSize|0,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const t=this._pointArray.length;t<l._minpicturebytes&&(e=1);const i=30+(e-1)/3|0,r=t/e|0;let n,a=r/l._nCycles|0,u=l._initAlpha,c=(this._networkSize>>3)*l._radiusBias,h=c>>l._radiusBiasShift;h<=1&&(h=0);for(let s=0;s<h;s++)this._radPower[s]=u*((h*h-s*s)*l._radBias/(h*h))>>>0;n=t<l._minpicturebytes?1:t%l._prime1!=0?l._prime1:t%l._prime2!=0?l._prime2:t%l._prime3!=0?l._prime3:l._prime4;const m=new s.ProgressTracker(r,99);for(let s=0,_=0;s<r;){m.shouldNotify(s)&&(yield{progress:m.progress});const e=this._pointArray[_],r=e.b<<o,d=e.g<<o,f=e.r<<o,p=e.a<<o,g=this._contest(r,d,f,p);if(this._alterSingle(u,g,r,d,f,p),0!==h&&this._alterNeighbour(h,g,r,d,f,p),(_+=n)>=t&&(_-=t),0===a&&(a=1),++s%a==0){u-=u/i|0,(h=(c-=c/l._radiusDecrease|0)>>l._radiusBiasShift)<=1&&(h=0);for(let e=0;e<h;e++)this._radPower[e]=u*((h*h-e*e)*l._radBias/(h*h))>>>0}}}_buildPalette(){const e=new r.Palette;return this._network.forEach(t=>{e.add(t.toPoint())}),e.sort(),e}_alterNeighbour(e,t,i,r,n,a){let s=t-e;s<-1&&(s=-1);let o=t+e;o>this._networkSize&&(o=this._networkSize);let u=t+1,c=t-1,h=1;for(;u<o||c>s;){const e=this._radPower[h++]/l._alphaRadBias;if(u<o){const t=this._network[u++];t.subtract(e*(t.r-n),e*(t.g-r),e*(t.b-i),e*(t.a-a))}if(c>s){const t=this._network[c--];t.subtract(e*(t.r-n),e*(t.g-r),e*(t.b-i),e*(t.a-a))}}}_alterSingle(e,t,i,r,n,a){e/=l._initAlpha;const s=this._network[t];s.subtract(e*(s.r-n),e*(s.g-r),e*(s.b-i),e*(s.a-a))}_contest(e,t,i,r){const n=1020<<o;let a=~(1<<31),s=a,u=-1,c=u;for(let h=0;h<this._networkSize;h++){const m=this._network[h],_=this._distance.calculateNormalized(m,{r:i,g:t,b:e,a:r})*n|0;_<a&&(a=_,u=h);const d=_-(this._bias[h]>>l._initialBiasShift-o);d<s&&(s=d,c=h);const f=this._freq[h]>>l._betaShift;this._freq[h]-=f,this._bias[h]+=f<<l._gammaShift}return this._freq[u]+=l._beta,this._bias[u]-=l._betaGamma,c}}i.NeuQuant=l,l._prime1=499,l._prime2=491,l._prime3=487,l._prime4=503,l._minpicturebytes=l._prime4,l._nCycles=100,l._initialBiasShift=16,l._initialBias=1<<l._initialBiasShift,l._gammaShift=10,l._betaShift=10,l._beta=l._initialBias>>l._betaShift,l._betaGamma=l._initialBias<<l._gammaShift-l._betaShift,l._radiusBiasShift=6,l._radiusBias=1<<l._radiusBiasShift,l._radiusDecrease=30,l._alphaBiasShift=10,l._initAlpha=1<<l._alphaBiasShift,l._radBiasShift=8,l._radBias=1<<l._radBiasShift,l._alphaRadBiasShift=l._alphaBiasShift+l._radBiasShift,l._alphaRadBias=1<<l._alphaRadBiasShift},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],fT9P:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NeuQuantFloat=void 0;var r=e("../../utils/palette"),n=e("../../utils/point"),a=e("../paletteQuantizer"),s=e("../../utils");const o=3;class u{constructor(e){this.r=this.g=this.b=this.a=e}toPoint(){return n.Point.createByRGBA(this.r>>o,this.g>>o,this.b>>o,this.a>>o)}subtract(e,t,i,r){this.r-=e,this.g-=t,this.b-=i,this.a-=r}}class l extends a.AbstractPaletteQuantizer{constructor(e,t=256){super(),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=t,this._distance.setWhitePoint(255<<o,255<<o,255<<o,255<<o)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new u((e<<o+8)/this._networkSize),this._freq[e]=l._initialBias/this._networkSize,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const t=this._pointArray.length;t<l._minpicturebytes&&(e=1);const i=30+(e-1)/3,r=t/e;let n,a=r/l._nCycles|0,u=l._initAlpha,c=(this._networkSize>>3)*l._radiusBias,h=c>>l._radiusBiasShift;h<=1&&(h=0);for(let s=0;s<h;s++)this._radPower[s]=u*((h*h-s*s)*l._radBias/(h*h));n=t<l._minpicturebytes?1:t%l._prime1!=0?l._prime1:t%l._prime2!=0?l._prime2:t%l._prime3!=0?l._prime3:l._prime4;const m=new s.ProgressTracker(r,99);for(let s=0,_=0;s<r;){m.shouldNotify(s)&&(yield{progress:m.progress});const e=this._pointArray[_],r=e.b<<o,d=e.g<<o,f=e.r<<o,p=e.a<<o,g=this._contest(r,d,f,p);if(this._alterSingle(u,g,r,d,f,p),0!==h&&this._alterNeighbour(h,g,r,d,f,p),(_+=n)>=t&&(_-=t),0===a&&(a=1),++s%a==0){u-=u/i,(h=(c-=c/l._radiusDecrease)>>l._radiusBiasShift)<=1&&(h=0);for(let e=0;e<h;e++)this._radPower[e]=u*((h*h-e*e)*l._radBias/(h*h))}}}_buildPalette(){const e=new r.Palette;return this._network.forEach(t=>{e.add(t.toPoint())}),e.sort(),e}_alterNeighbour(e,t,i,r,n,a){let s=t-e;s<-1&&(s=-1);let o=t+e;o>this._networkSize&&(o=this._networkSize);let u=t+1,c=t-1,h=1;for(;u<o||c>s;){const e=this._radPower[h++]/l._alphaRadBias;if(u<o){const t=this._network[u++];t.subtract(e*(t.r-n),e*(t.g-r),e*(t.b-i),e*(t.a-a))}if(c>s){const t=this._network[c--];t.subtract(e*(t.r-n),e*(t.g-r),e*(t.b-i),e*(t.a-a))}}}_alterSingle(e,t,i,r,n,a){e/=l._initAlpha;const s=this._network[t];s.subtract(e*(s.r-n),e*(s.g-r),e*(s.b-i),e*(s.a-a))}_contest(e,t,i,r){const n=1020<<o;let a=~(1<<31),s=a,u=-1,c=u;for(let h=0;h<this._networkSize;h++){const m=this._network[h],_=this._distance.calculateNormalized(m,{r:i,g:t,b:e,a:r})*n;_<a&&(a=_,u=h);const d=_-(this._bias[h]>>l._initialBiasShift-o);d<s&&(s=d,c=h);const f=this._freq[h]>>l._betaShift;this._freq[h]-=f,this._bias[h]+=f<<l._gammaShift}return this._freq[u]+=l._beta,this._bias[u]-=l._betaGamma,c}}i.NeuQuantFloat=l,l._prime1=499,l._prime2=491,l._prime3=487,l._prime4=503,l._minpicturebytes=l._prime4,l._nCycles=100,l._initialBiasShift=16,l._initialBias=1<<l._initialBiasShift,l._gammaShift=10,l._betaShift=10,l._beta=l._initialBias>>l._betaShift,l._betaGamma=l._initialBias<<l._gammaShift-l._betaShift,l._radiusBiasShift=6,l._radiusBias=1<<l._radiusBiasShift,l._radiusDecrease=30,l._alphaBiasShift=10,l._initAlpha=1<<l._alphaBiasShift,l._radBiasShift=8,l._radBias=1<<l._radBiasShift,l._alphaRadBiasShift=l._alphaBiasShift+l._radBiasShift,l._alphaRadBias=1<<l._alphaRadBiasShift},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],OrD7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ColorHistogram=void 0;var r=e("../../utils/hueStatistics"),n=e("../../utils/arithmetic");class a{constructor(e,t){this._method=e,this._minHueCols=t<<2,this._initColors=t<<2,this._hueStats=new r.HueStatistics(a._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(e){switch(this._method){case 1:this._colorStats1D(e);break;case 2:this._colorStats2D(e)}}getImportanceSortedColorsIDXI32(){const e=(0,n.stableSort)(Object.keys(this._histogram),(e,t)=>this._histogram[t]-this._histogram[e]);if(0===e.length)return[];let t;switch(this._method){case 1:const i=Math.min(e.length,this._initColors),r=e[i-1],n=this._histogram[r];t=e.slice(0,i);let a=i;const s=e.length;for(;a<s&&this._histogram[e[a]]===n;)t.push(e[a++]);this._hueStats.injectIntoArray(t);break;case 2:t=e;break;default:throw new Error("Incorrect method")}return t.map(function(e){return+e})}_colorStats1D(e){const t=this._histogram,i=e.getPointArray(),r=i.length;for(let n=0;n<r;n++){const e=i[n].uint32;this._hueStats.check(e),e in t?t[e]++:t[e]=1}}_colorStats2D(e){const t=e.getWidth(),i=e.getHeight(),r=e.getPointArray(),n=a._boxSize[0],s=a._boxSize[1],o=n*s,u=this._makeBoxes(t,i,n,s),l=this._histogram;u.forEach(e=>{let i=Math.round(e.w*e.h/o)*a._boxPixels;i<2&&(i=2);const n={};this._iterateBox(e,t,e=>{const t=r[e].uint32;this._hueStats.check(t),t in l?l[t]++:t in n?++n[t]>=i&&(l[t]=n[t]):n[t]=1})}),this._hueStats.injectIntoDictionary(l)}_iterateBox(e,t,i){const r=e,n=r.y*t+r.x,a=(r.y+r.h-1)*t+(r.x+r.w-1),s=t-r.w+1;let o=0,u=n;do{i.call(this,u),u+=++o%r.w==0?s:1}while(u<=a)}_makeBoxes(e,t,i,r){const n=e%i,a=t%r,s=e-n,o=t-a,u=[];for(let l=0;l<t;l+=r)for(let t=0;t<e;t+=i)u.push({x:t,y:l,w:t===s?n:i,h:l===o?a:r});return u}}i.ColorHistogram=a,a._boxSize=[64,64],a._boxPixels=2,a._hueGroups=10},{"../../utils/hueStatistics":"sduU","../../utils/arithmetic":"b3mL"}],vmhr:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.RGBQuant=void 0;var r=e("../../utils/palette"),n=e("../../utils/point"),a=e("./colorHistogram"),s=e("../paletteQuantizer"),o=e("../../utils/arithmetic"),u=e("../../utils");class l{constructor(e,t,i){this.index=e,this.color=t,this.distance=i}}i.RGBQuant=class extends s.AbstractPaletteQuantizer{constructor(e,t=256,i=2){super(),this._distance=e,this._colors=t,this._histogram=new a.ColorHistogram(i,t),this._initialDistance=.01,this._distanceIncrement=.005}sample(e){this._histogram.sample(e)}*quantize(){const e=this._histogram.getImportanceSortedColorsIDXI32();if(0===e.length)throw new Error("No colors in image");yield*this._buildPalette(e)}*_buildPalette(e){const t=new r.Palette,i=t.getPointContainer().getPointArray(),a=new Array(e.length);for(let r=0;r<e.length;r++)i.push(n.Point.createByUint32(e[r])),a[r]=1;const s=i.length,c=[];let h=s,m=this._initialDistance;const _=new u.ProgressTracker(h-this._colors,99);for(;h>this._colors;){c.length=0;for(let e=0;e<s;e++){if(_.shouldNotify(s-h)&&(yield{progress:_.progress}),0===a[e])continue;const t=i[e];for(let r=e+1;r<s;r++){if(0===a[r])continue;const e=i[r],n=this._distance.calculateNormalized(t,e);n<m&&(c.push(new l(r,e,n)),a[r]=0,h--)}}m+=h>3*this._colors?this._initialDistance:this._distanceIncrement}if(h<this._colors){(0,o.stableSort)(c,function(e,t){return t.distance-e.distance});let e=0;for(;h<this._colors&&e<c.length;)a[c[e].index]=1,h++,e++}let d=i.length;for(let r=d-1;r>=0;r--)0===a[r]&&(r!==d-1&&(i[r]=i[d-1]),--d);i.length=d,t.sort(),yield{palette:t,progress:100}}}},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","./colorHistogram":"OrD7","../paletteQuantizer":"gm7f","../../utils/arithmetic":"b3mL","../../utils":"MRhM"}],YOKj:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.WuQuant=i.WuColorCube=void 0;var r=e("../../utils/palette"),n=e("../../utils/point"),a=e("../paletteQuantizer"),s=e("../../utils");function o(e){const t=[];for(let i=0;i<e;i++)t[i]=0;return t}function u(e,t,i,r){const n=new Array(e);for(let a=0;a<e;a++){n[a]=new Array(t);for(let e=0;e<t;e++){n[a][e]=new Array(i);for(let t=0;t<i;t++){n[a][e][t]=new Array(r);for(let i=0;i<r;i++)n[a][e][t][i]=0}}}return n}function l(e,t,i){const r=new Array(e);for(let n=0;n<e;n++){r[n]=new Array(t);for(let e=0;e<t;e++){r[n][e]=new Array(i);for(let t=0;t<i;t++)r[n][e][t]=0}}return r}function c(e,t,i,r,n){for(let a=0;a<t;a++){e[a]=[];for(let t=0;t<i;t++){e[a][t]=[];for(let i=0;i<r;i++)e[a][t][i]=n}}}function h(e,t,i){for(let r=0;r<t;r++)e[r]=i}class m{}i.WuColorCube=m;class _ extends a.AbstractPaletteQuantizer{constructor(e,t=256,i=5){super(),this._distance=e,this._setQuality(i),this._initialize(t)}sample(e){const t=e.getPointArray();for(let i=0,r=t.length;i<r;i++)this._addColor(t[i]);this._pixels=this._pixels.concat(t)}*quantize(){yield*this._preparePalette();const e=new r.Palette;for(let t=0;t<this._colors;t++)if(this._sums[t]>0){const i=this._sums[t],r=this._reds[t]/i,a=this._greens[t]/i,s=this._blues[t]/i,o=this._alphas[t]/i,u=n.Point.createByRGBA(0|r,0|a,0|s,0|o);e.add(u)}e.sort(),yield{palette:e,progress:100}}*_preparePalette(){yield*this._calculateMoments();let e=0;const t=o(this._colors);for(let s=1;s<this._colors;++s){this._cut(this._cubes[e],this._cubes[s])?(t[e]=this._cubes[e].volume>1?this._calculateVariance(this._cubes[e]):0,t[s]=this._cubes[s].volume>1?this._calculateVariance(this._cubes[s]):0):(t[e]=0,s--),e=0;let i=t[0];for(let r=1;r<=s;++r)t[r]>i&&(i=t[r],e=r);if(i<=0){this._colors=s+1;break}}const i=[],r=[],n=[],a=[];for(let s=0;s<this._colors;++s){const e=_._volume(this._cubes[s],this._weights);e>0?(i[s]=_._volume(this._cubes[s],this._momentsRed)/e|0,r[s]=_._volume(this._cubes[s],this._momentsGreen)/e|0,n[s]=_._volume(this._cubes[s],this._momentsBlue)/e|0,a[s]=_._volume(this._cubes[s],this._momentsAlpha)/e|0):(i[s]=0,r[s]=0,n[s]=0,a[s]=0)}this._reds=o(this._colors+1),this._greens=o(this._colors+1),this._blues=o(this._colors+1),this._alphas=o(this._colors+1),this._sums=o(this._colors+1);for(let s=0,o=this._pixels.length;s<o;s++){const e=this._pixels[s];let t=-1,o=Number.MAX_VALUE;for(let s=0;s<this._colors;s++){const u=i[s],l=r[s],c=n[s],h=a[s],m=this._distance.calculateRaw(u,l,c,h,e.r,e.g,e.b,e.a);m<o&&(o=m,t=s)}this._reds[t]+=e.r,this._greens[t]+=e.g,this._blues[t]+=e.b,this._alphas[t]+=e.a,this._sums[t]++}}_addColor(e){const t=8-this._significantBitsPerChannel,i=1+(e.r>>t),r=1+(e.g>>t),n=1+(e.b>>t),a=1+(e.a>>t);this._weights[a][i][r][n]++,this._momentsRed[a][i][r][n]+=e.r,this._momentsGreen[a][i][r][n]+=e.g,this._momentsBlue[a][i][r][n]+=e.b,this._momentsAlpha[a][i][r][n]+=e.a,this._moments[a][i][r][n]+=this._table[e.r]+this._table[e.g]+this._table[e.b]+this._table[e.a]}*_calculateMoments(){const e=[],t=[],i=[],r=[],n=[],a=[],o=l(this._sideSize,this._sideSize,this._sideSize),u=l(this._sideSize,this._sideSize,this._sideSize),m=l(this._sideSize,this._sideSize,this._sideSize),_=l(this._sideSize,this._sideSize,this._sideSize),d=l(this._sideSize,this._sideSize,this._sideSize),f=l(this._sideSize,this._sideSize,this._sideSize);let p=0;const g=new s.ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let s=1;s<=this._alphaMaxSideIndex;++s){c(o,this._sideSize,this._sideSize,this._sideSize,0),c(u,this._sideSize,this._sideSize,this._sideSize,0),c(m,this._sideSize,this._sideSize,this._sideSize,0),c(_,this._sideSize,this._sideSize,this._sideSize,0),c(d,this._sideSize,this._sideSize,this._sideSize,0),c(f,this._sideSize,this._sideSize,this._sideSize,0);for(let l=1;l<=this._maxSideIndex;++l,++p){g.shouldNotify(p)&&(yield{progress:g.progress}),h(e,this._sideSize,0),h(t,this._sideSize,0),h(i,this._sideSize,0),h(r,this._sideSize,0),h(n,this._sideSize,0),h(a,this._sideSize,0);for(let c=1;c<=this._maxSideIndex;++c){let h=0,p=0,g=0,b=0,M=0,y=0;for(let x=1;x<=this._maxSideIndex;++x)h+=this._weights[s][l][c][x],p+=this._momentsRed[s][l][c][x],g+=this._momentsGreen[s][l][c][x],b+=this._momentsBlue[s][l][c][x],M+=this._momentsAlpha[s][l][c][x],y+=this._moments[s][l][c][x],e[x]+=h,t[x]+=p,i[x]+=g,r[x]+=b,n[x]+=M,a[x]+=y,o[l][c][x]=o[l-1][c][x]+e[x],u[l][c][x]=u[l-1][c][x]+t[x],m[l][c][x]=m[l-1][c][x]+i[x],_[l][c][x]=_[l-1][c][x]+r[x],d[l][c][x]=d[l-1][c][x]+n[x],f[l][c][x]=f[l-1][c][x]+a[x],this._weights[s][l][c][x]=this._weights[s-1][l][c][x]+o[l][c][x],this._momentsRed[s][l][c][x]=this._momentsRed[s-1][l][c][x]+u[l][c][x],this._momentsGreen[s][l][c][x]=this._momentsGreen[s-1][l][c][x]+m[l][c][x],this._momentsBlue[s][l][c][x]=this._momentsBlue[s-1][l][c][x]+_[l][c][x],this._momentsAlpha[s][l][c][x]=this._momentsAlpha[s-1][l][c][x]+d[l][c][x],this._moments[s][l][c][x]=this._moments[s-1][l][c][x]+f[l][c][x]}}}}static _volumeFloat(e,t){return t[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMaximum]-t[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]-t[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+t[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]-t[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+t[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+t[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-t[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(t[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]-t[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]-t[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+t[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-t[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+t[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]+t[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-t[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum])}static _volume(e,t){return 0|_._volumeFloat(e,t)}static _top(e,t,i,r){let n;switch(t){case _._alpha:n=r[i][e.redMaximum][e.greenMaximum][e.blueMaximum]-r[i][e.redMaximum][e.greenMinimum][e.blueMaximum]-r[i][e.redMinimum][e.greenMaximum][e.blueMaximum]+r[i][e.redMinimum][e.greenMinimum][e.blueMaximum]-(r[i][e.redMaximum][e.greenMaximum][e.blueMinimum]-r[i][e.redMaximum][e.greenMinimum][e.blueMinimum]-r[i][e.redMinimum][e.greenMaximum][e.blueMinimum]+r[i][e.redMinimum][e.greenMinimum][e.blueMinimum]);break;case _._red:n=r[e.alphaMaximum][i][e.greenMaximum][e.blueMaximum]-r[e.alphaMaximum][i][e.greenMinimum][e.blueMaximum]-r[e.alphaMinimum][i][e.greenMaximum][e.blueMaximum]+r[e.alphaMinimum][i][e.greenMinimum][e.blueMaximum]-(r[e.alphaMaximum][i][e.greenMaximum][e.blueMinimum]-r[e.alphaMaximum][i][e.greenMinimum][e.blueMinimum]-r[e.alphaMinimum][i][e.greenMaximum][e.blueMinimum]+r[e.alphaMinimum][i][e.greenMinimum][e.blueMinimum]);break;case _._green:n=r[e.alphaMaximum][e.redMaximum][i][e.blueMaximum]-r[e.alphaMaximum][e.redMinimum][i][e.blueMaximum]-r[e.alphaMinimum][e.redMaximum][i][e.blueMaximum]+r[e.alphaMinimum][e.redMinimum][i][e.blueMaximum]-(r[e.alphaMaximum][e.redMaximum][i][e.blueMinimum]-r[e.alphaMaximum][e.redMinimum][i][e.blueMinimum]-r[e.alphaMinimum][e.redMaximum][i][e.blueMinimum]+r[e.alphaMinimum][e.redMinimum][i][e.blueMinimum]);break;case _._blue:n=r[e.alphaMaximum][e.redMaximum][e.greenMaximum][i]-r[e.alphaMaximum][e.redMaximum][e.greenMinimum][i]-r[e.alphaMaximum][e.redMinimum][e.greenMaximum][i]+r[e.alphaMaximum][e.redMinimum][e.greenMinimum][i]-(r[e.alphaMinimum][e.redMaximum][e.greenMaximum][i]-r[e.alphaMinimum][e.redMaximum][e.greenMinimum][i]-r[e.alphaMinimum][e.redMinimum][e.greenMaximum][i]+r[e.alphaMinimum][e.redMinimum][e.greenMinimum][i]);break;default:throw new Error("impossible")}return 0|n}static _bottom(e,t,i){switch(t){case _._alpha:return-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _._red:return-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _._green:return-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _._blue:return-i[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]+i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]-i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-(-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);default:return 0}}_calculateVariance(e){const t=_._volume(e,this._momentsRed),i=_._volume(e,this._momentsGreen),r=_._volume(e,this._momentsBlue),n=_._volume(e,this._momentsAlpha);return _._volumeFloat(e,this._moments)-(t*t+i*i+r*r+n*n)/_._volume(e,this._weights)}_maximize(e,t,i,r,n,a,s,o,u){const l=0|_._bottom(e,t,this._momentsRed),c=0|_._bottom(e,t,this._momentsGreen),h=0|_._bottom(e,t,this._momentsBlue),m=0|_._bottom(e,t,this._momentsAlpha),d=0|_._bottom(e,t,this._weights);let f=0,p=-1;for(let g=i;g<r;++g){let i=l+_._top(e,t,g,this._momentsRed),r=c+_._top(e,t,g,this._momentsGreen),b=h+_._top(e,t,g,this._momentsBlue),M=m+_._top(e,t,g,this._momentsAlpha),y=d+_._top(e,t,g,this._weights);if(0!==y){let e=i*i+r*r+b*b+M*M,t=e/y;i=n-i,r=a-r,b=s-b,M=o-M,0!=(y=u-y)&&(t+=(e=i*i+r*r+b*b+M*M)/y)>f&&(f=t,p=g)}}return{max:f,position:p}}_cut(e,t){let i;const r=_._volume(e,this._momentsRed),n=_._volume(e,this._momentsGreen),a=_._volume(e,this._momentsBlue),s=_._volume(e,this._momentsAlpha),o=_._volume(e,this._weights),u=this._maximize(e,_._red,e.redMinimum+1,e.redMaximum,r,n,a,s,o),l=this._maximize(e,_._green,e.greenMinimum+1,e.greenMaximum,r,n,a,s,o),c=this._maximize(e,_._blue,e.blueMinimum+1,e.blueMaximum,r,n,a,s,o),h=this._maximize(e,_._alpha,e.alphaMinimum+1,e.alphaMaximum,r,n,a,s,o);if(h.max>=u.max&&h.max>=l.max&&h.max>=c.max){if(i=_._alpha,h.position<0)return!1}else i=u.max>=h.max&&u.max>=l.max&&u.max>=c.max?_._red:l.max>=h.max&&l.max>=u.max&&l.max>=c.max?_._green:_._blue;switch(t.redMaximum=e.redMaximum,t.greenMaximum=e.greenMaximum,t.blueMaximum=e.blueMaximum,t.alphaMaximum=e.alphaMaximum,i){case _._red:t.redMinimum=e.redMaximum=u.position,t.greenMinimum=e.greenMinimum,t.blueMinimum=e.blueMinimum,t.alphaMinimum=e.alphaMinimum;break;case _._green:t.greenMinimum=e.greenMaximum=l.position,t.redMinimum=e.redMinimum,t.blueMinimum=e.blueMinimum,t.alphaMinimum=e.alphaMinimum;break;case _._blue:t.blueMinimum=e.blueMaximum=c.position,t.redMinimum=e.redMinimum,t.greenMinimum=e.greenMinimum,t.alphaMinimum=e.alphaMinimum;break;case _._alpha:t.alphaMinimum=e.alphaMaximum=h.position,t.blueMinimum=e.blueMinimum,t.redMinimum=e.redMinimum,t.greenMinimum=e.greenMinimum}return e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),t.volume=(t.redMaximum-t.redMinimum)*(t.greenMaximum-t.greenMinimum)*(t.blueMaximum-t.blueMinimum)*(t.alphaMaximum-t.alphaMinimum),!0}_initialize(e){this._colors=e,this._cubes=[];for(let t=0;t<e;t++)this._cubes[t]=new m;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=u(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let t=0;t<256;++t)this._table[t]=t*t;this._pixels=[]}_setQuality(e=5){this._significantBitsPerChannel=e,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}}i.WuQuant=_,_._alpha=3,_._red=2,_._green=1,_._blue=0},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],usjm:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AbstractPaletteQuantizer",{enumerable:!0,get:function(){return r.AbstractPaletteQuantizer}}),Object.defineProperty(i,"NeuQuant",{enumerable:!0,get:function(){return n.NeuQuant}}),Object.defineProperty(i,"NeuQuantFloat",{enumerable:!0,get:function(){return a.NeuQuantFloat}}),Object.defineProperty(i,"RGBQuant",{enumerable:!0,get:function(){return s.RGBQuant}}),Object.defineProperty(i,"ColorHistogram",{enumerable:!0,get:function(){return o.ColorHistogram}}),Object.defineProperty(i,"WuQuant",{enumerable:!0,get:function(){return u.WuQuant}}),Object.defineProperty(i,"WuColorCube",{enumerable:!0,get:function(){return u.WuColorCube}});var r=e("./paletteQuantizer"),n=e("./neuquant/neuquant"),a=e("./neuquant/neuquantFloat"),s=e("./rgbquant/rgbquant"),o=e("./rgbquant/colorHistogram"),u=e("./wu/wuQuant")},{"./paletteQuantizer":"gm7f","./neuquant/neuquant":"TSYH","./neuquant/neuquantFloat":"fT9P","./rgbquant/rgbquant":"vmhr","./rgbquant/colorHistogram":"OrD7","./wu/wuQuant":"YOKj"}],pUS7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.AbstractImageQuantizer=void 0,i.AbstractImageQuantizer=class{quantizeSync(e,t){for(const i of this.quantize(e,t))if(i.pointContainer)return i.pointContainer;throw new Error("unreachable")}}},{}],cReF:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NearestColor=void 0;var r=e("./imageQuantizer"),n=e("../utils/progressTracker");i.NearestColor=class extends r.AbstractImageQuantizer{constructor(e){super(),this._distance=e}*quantize(e,t){const i=e.getPointArray(),r=e.getWidth(),a=e.getHeight(),s=new n.ProgressTracker(a,99);for(let n=0;n<a;n++){s.shouldNotify(n)&&(yield{progress:s.progress});for(let e=0,a=n*r;e<r;e++,a++){const e=i[a];e.from(t.getNearestColor(this._distance,e))}}yield{pointContainer:e,progress:100}}}},{"./imageQuantizer":"pUS7","../utils/progressTracker":"ywMQ"}],KQk7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ErrorDiffusionArray=i.ErrorDiffusionArrayKernel=void 0;var r,n=e("./imageQuantizer"),a=e("../utils/point"),s=e("../utils/arithmetic"),o=e("../utils/progressTracker");i.ErrorDiffusionArrayKernel=r,function(e){e[e.FloydSteinberg=0]="FloydSteinberg",e[e.FalseFloydSteinberg=1]="FalseFloydSteinberg",e[e.Stucki=2]="Stucki",e[e.Atkinson=3]="Atkinson",e[e.Jarvis=4]="Jarvis",e[e.Burkes=5]="Burkes",e[e.Sierra=6]="Sierra",e[e.TwoSierra=7]="TwoSierra",e[e.SierraLite=8]="SierraLite"}(r||(i.ErrorDiffusionArrayKernel=r={})),i.ErrorDiffusionArray=class extends n.AbstractImageQuantizer{constructor(e,t,i=!0,r=0,n=!1){super(),this._setKernel(t),this._distance=e,this._minColorDistance=r,this._serpentine=i,this._calculateErrorLikeGIMP=n}*quantize(e,t){const i=e.getPointArray(),r=new a.Point,n=e.getWidth(),u=e.getHeight(),l=[];let c=1,h=1;for(const a of this._kernel){const e=a[2]+1;h<e&&(h=e)}for(let a=0;a<h;a++)this._fillErrorLine(l[a]=[],n);const m=new o.ProgressTracker(u,99);for(let o=0;o<u;o++){m.shouldNotify(o)&&(yield{progress:m.progress}),this._serpentine&&(c*=-1);const e=o*n,h=1===c?0:n-1,_=1===c?n:-1;this._fillErrorLine(l[0],n),l.push(l.shift());const d=l[0];for(let m=h,f=e+h;m!==_;m+=c,f+=c){const e=i[f],h=d[m];r.from(e);const _=a.Point.createByRGBA((0,s.inRange0to255Rounded)(e.r+h[0]),(0,s.inRange0to255Rounded)(e.g+h[1]),(0,s.inRange0to255Rounded)(e.b+h[2]),(0,s.inRange0to255Rounded)(e.a+h[3])),p=t.getNearestColor(this._distance,_);if(e.from(p),this._minColorDistance&&this._distance.calculateNormalized(e,p)<this._minColorDistance)continue;let g,b,M,y;this._calculateErrorLikeGIMP?(g=_.r-p.r,b=_.g-p.g,M=_.b-p.b,y=_.a-p.a):(g=r.r-p.r,b=r.g-p.g,M=r.b-p.b,y=r.a-p.a);const x=1===c?0:this._kernel.length-1,w=1===c?this._kernel.length:-1;for(let t=x;t!==w;t+=c){const e=this._kernel[t][1]*c,i=this._kernel[t][2];if(e+m>=0&&e+m<n&&i+o>=0&&i+o<u){const r=this._kernel[t][0],n=l[i][e+m];n[0]=n[0]+g*r,n[1]=n[1]+b*r,n[2]=n[2]+M*r,n[3]=n[3]+y*r}}}}yield{pointContainer:e,progress:100}}_fillErrorLine(e,t){e.length>t&&(e.length=t);const i=e.length;for(let r=0;r<i;r++){const t=e[r];t[0]=t[1]=t[2]=t[3]=0}for(let r=i;r<t;r++)e[r]=[0,0,0,0]}_setKernel(e){switch(e){case r.FloydSteinberg:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case r.FalseFloydSteinberg:this._kernel=[[3/8,1,0],[3/8,0,1],[.25,1,1]];break;case r.Stucki:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case r.Atkinson:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case r.Jarvis:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case r.Burkes:this._kernel=[[.25,1,0],[.125,2,0],[2/32,-2,1],[.125,-1,1],[.25,0,1],[.125,1,1],[2/32,2,1]];break;case r.Sierra:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[.125,-1,1],[5/32,0,1],[.125,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case r.TwoSierra:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[.125,-1,1],[3/16,0,1],[.125,1,1],[1/16,2,1]];break;case r.SierraLite:this._kernel=[[.5,1,0],[.25,-1,1],[.25,0,1]];break;default:throw new Error("ErrorDiffusionArray: unknown kernel = "+e)}}}},{"./imageQuantizer":"pUS7","../utils/point":"AzZH","../utils/arithmetic":"b3mL","../utils/progressTracker":"ywMQ"}],Qgra:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.hilbertCurve=function*(e,t,i){const s=Math.max(e,t),o={width:e,height:t,level:Math.floor(Math.log(s)/Math.log(2)+1),callback:i,tracker:new n.ProgressTracker(e*t,99),index:0,x:0,y:0};yield*function*e(t,i){if(!(t.level<1)){switch(t.tracker.shouldNotify(t.index)&&(yield{progress:t.tracker.progress}),t.level--,i){case r.LEFT:yield*e(t,r.UP),a(t,r.RIGHT),yield*e(t,r.LEFT),a(t,r.DOWN),yield*e(t,r.LEFT),a(t,r.LEFT),yield*e(t,r.DOWN);break;case r.RIGHT:yield*e(t,r.DOWN),a(t,r.LEFT),yield*e(t,r.RIGHT),a(t,r.UP),yield*e(t,r.RIGHT),a(t,r.RIGHT),yield*e(t,r.UP);break;case r.UP:yield*e(t,r.LEFT),a(t,r.DOWN),yield*e(t,r.UP),a(t,r.RIGHT),yield*e(t,r.UP),a(t,r.UP),yield*e(t,r.RIGHT);break;case r.DOWN:yield*e(t,r.RIGHT),a(t,r.UP),yield*e(t,r.DOWN),a(t,r.LEFT),yield*e(t,r.DOWN),a(t,r.DOWN),yield*e(t,r.LEFT)}t.level++}}(o,r.UP),a(o,r.NONE)};var r,n=e("../../utils/progressTracker");function a(e,t){switch(e.x>=0&&e.x<e.width&&e.y>=0&&e.y<e.height&&(e.callback(e.x,e.y),e.index++),t){case r.LEFT:e.x--;break;case r.RIGHT:e.x++;break;case r.UP:e.y--;break;case r.DOWN:e.y++}}!function(e){e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.DOWN=4]="DOWN"}(r||(r={}))},{"../../utils/progressTracker":"ywMQ"}],XWAF:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ErrorDiffusionRiemersma=void 0;var r=e("./imageQuantizer"),n=e("./spaceFillingCurves/hilbertCurve"),a=e("../utils/point"),s=e("../utils/arithmetic");class o extends r.AbstractImageQuantizer{constructor(e,t=16,i=1){super(),this._distance=e,this._errorQueueSize=t,this._weights=o._createWeights(i,t)}*quantize(e,t){const i=e.getPointArray(),r=e.getWidth(),o=e.getHeight(),u=[];let l=0;for(let n=0;n<this._errorQueueSize;n++)u[n]={r:0,g:0,b:0,a:0};yield*(0,n.hilbertCurve)(r,o,(e,n)=>{const o=i[e+n*r];let c=o.r,h=o.g,m=o.b,_=o.a;for(let t=0;t<this._errorQueueSize;t++){const e=this._weights[t],i=u[(t+l)%this._errorQueueSize];c+=i.r*e,h+=i.g*e,m+=i.b*e,_+=i.a*e}const d=a.Point.createByRGBA((0,s.inRange0to255Rounded)(c),(0,s.inRange0to255Rounded)(h),(0,s.inRange0to255Rounded)(m),(0,s.inRange0to255Rounded)(_)),f=t.getNearestColor(this._distance,d),p=((l=(l+1)%this._errorQueueSize)+this._errorQueueSize-1)%this._errorQueueSize;u[p].r=o.r-f.r,u[p].g=o.g-f.g,u[p].b=o.b-f.b,u[p].a=o.a-f.a,o.from(f)}),yield{pointContainer:e,progress:100}}static _createWeights(e,t){const i=[],r=Math.exp(Math.log(t)/(t-1));for(let n=0,a=1;n<t;n++)i[n]=(a+.5|0)/t*e,a*=r;return i}}i.ErrorDiffusionRiemersma=o},{"./imageQuantizer":"pUS7","./spaceFillingCurves/hilbertCurve":"Qgra","../utils/point":"AzZH","../utils/arithmetic":"b3mL"}],d99G:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AbstractImageQuantizer",{enumerable:!0,get:function(){return r.AbstractImageQuantizer}}),Object.defineProperty(i,"NearestColor",{enumerable:!0,get:function(){return n.NearestColor}}),Object.defineProperty(i,"ErrorDiffusionArray",{enumerable:!0,get:function(){return a.ErrorDiffusionArray}}),Object.defineProperty(i,"ErrorDiffusionArrayKernel",{enumerable:!0,get:function(){return a.ErrorDiffusionArrayKernel}}),Object.defineProperty(i,"ErrorDiffusionRiemersma",{enumerable:!0,get:function(){return s.ErrorDiffusionRiemersma}});var r=e("./imageQuantizer"),n=e("./nearestColor"),a=e("./array"),s=e("./riemersma")},{"./imageQuantizer":"pUS7","./nearestColor":"cReF","./array":"KQk7","./riemersma":"XWAF"}],a6Uv:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ssim=function(e,t){if(e.getHeight()!==t.getHeight()||e.getWidth()!==t.getWidth())throw new Error("Images have different sizes!");const i=Math.pow(255*n,2),r=Math.pow(255*a,2);let o=0,u=0;return s(e,t,(e,t,n,a)=>{let s=0,l=0,c=0;for(let i=0;i<e.length;i++)l+=Math.pow(e[i]-n,2),c+=Math.pow(t[i]-a,2),s+=(e[i]-n)*(t[i]-a);const h=e.length-1;l/=h,c/=h;const m=(2*n*a+i)*(2*(s/=h)+r),_=(Math.pow(n,2)+Math.pow(a,2)+i)*(l+c+r);u+=m/_,o++}),u/o};var r=e("../constants/bt709");const n=.01,a=.03;function s(e,t,i){const r=e.getWidth(),n=e.getHeight();for(let a=0;a<n;a+=8)for(let s=0;s<r;s+=8){const l=Math.min(8,r-s),c=Math.min(8,n-a),h=o(e,s,a,l,c),m=o(t,s,a,l,c);i(h,m,u(h),u(m))}}function o(e,t,i,n,a){const s=e.getPointArray(),o=[];let u=0;for(let l=i;l<i+a;l++){const i=l*e.getWidth();for(let e=t;e<t+n;e++){const t=s[i+e];o[u]=t.r*r.Y.RED+t.g*r.Y.GREEN+t.b*r.Y.BLUE,u++}}return o}function u(e){let t=0;for(const i of e)t+=i;return t/e.length}},{"../constants/bt709":"Spxq"}],yZRa:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"ssim",{enumerable:!0,get:function(){return r.ssim}});var r=e("./ssim")},{"./ssim":"a6Uv"}],kql1:[function(e,t,i){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],KVo1:[function(e,t,i){var r=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},{}],SP6V:[function(e,t,i){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],DBsB:[function(e,t,i){var r=e("./_is-object");t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":"SP6V"}],e5TU:[function(e,t,i){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],ZJLI:[function(e,t,i){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":"e5TU"}],dDni:[function(e,t,i){var r=e("./_is-object"),n=e("./_global").document,a=r(n)&&r(n.createElement);t.exports=function(e){return a?n.createElement(e):{}}},{"./_is-object":"SP6V","./_global":"kql1"}],UUWM:[function(e,t,i){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":"ZJLI","./_fails":"e5TU","./_dom-create":"dDni"}],PUNq:[function(e,t,i){var r=e("./_is-object");t.exports=function(e,t){if(!r(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!r(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":"SP6V"}],wvco:[function(e,t,i){var r=e("./_an-object"),n=e("./_ie8-dom-define"),a=e("./_to-primitive"),s=Object.defineProperty;i.f=e("./_descriptors")?Object.defineProperty:function(e,t,i){if(r(e),t=a(t,!0),r(i),n)try{return s(e,t,i)}catch(o){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},{"./_an-object":"DBsB","./_ie8-dom-define":"UUWM","./_to-primitive":"PUNq","./_descriptors":"ZJLI"}],B9EI:[function(e,t,i){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],i5RL:[function(e,t,i){var r=e("./_object-dp"),n=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,i){return r.f(e,t,n(1,i))}:function(e,t,i){return e[t]=i,e}},{"./_object-dp":"wvco","./_property-desc":"B9EI","./_descriptors":"ZJLI"}],nW2g:[function(e,t,i){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],f0sk:[function(e,t,i){var r=0,n=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},{}],Nw1e:[function(e,t,i){t.exports=!1},{}],sTGr:[function(e,t,i){var r=e("./_core"),n=e("./_global"),a="__core-js_shared__",s=n[a]||(n[a]={});(t.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:e("./_library")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},{"./_core":"KVo1","./_global":"kql1","./_library":"Nw1e"}],xZwm:[function(e,t,i){t.exports=e("./_shared")("native-function-to-string",Function.toString)},{"./_shared":"sTGr"}],l2hW:[function(e,t,i){var r=e("./_global"),n=e("./_hide"),a=e("./_has"),s=e("./_uid")("src"),o=e("./_function-to-string"),u="toString",l=(""+o).split(u);e("./_core").inspectSource=function(e){return o.call(e)},(t.exports=function(e,t,i,o){var u="function"==typeof i;u&&(a(i,"name")||n(i,"name",t)),e[t]!==i&&(u&&(a(i,s)||n(i,s,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=i:o?e[t]?e[t]=i:n(e,t,i):(delete e[t],n(e,t,i)))})(Function.prototype,u,function(){return"function"==typeof this&&this[s]||o.call(this)})},{"./_global":"kql1","./_hide":"i5RL","./_has":"nW2g","./_uid":"f0sk","./_function-to-string":"xZwm","./_core":"KVo1"}],L6p4:[function(e,t,i){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],N9ch:[function(e,t,i){var r=e("./_a-function");t.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,n){return e.call(t,i,r,n)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":"L6p4"}],NjVL:[function(e,t,i){var r=e("./_global"),n=e("./_core"),a=e("./_hide"),s=e("./_redefine"),o=e("./_ctx"),u="prototype",l=function(e,t,i){var c,h,m,_,d=e&l.F,f=e&l.G,p=e&l.S,g=e&l.P,b=e&l.B,M=f?r:p?r[t]||(r[t]={}):(r[t]||{})[u],y=f?n:n[t]||(n[t]={}),x=y[u]||(y[u]={});for(c in f&&(i=t),i)m=((h=!d&&M&&void 0!==M[c])?M:i)[c],_=b&&h?o(m,r):g&&"function"==typeof m?o(Function.call,m):m,M&&s(M,c,m,e&l.U),y[c]!=m&&a(y,c,_),g&&x[c]!=m&&(x[c]=m)};r.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{"./_global":"kql1","./_core":"KVo1","./_hide":"i5RL","./_redefine":"l2hW","./_ctx":"N9ch"}],TTev:[function(e,t,i){t.exports=function(e,t,i){var r=void 0===i;switch(t.length){case 0:return r?e():e.call(i);case 1:return r?e(t[0]):e.call(i,t[0]);case 2:return r?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},{}],DBa9:[function(e,t,i){var r=e("./_global").document;t.exports=r&&r.documentElement},{"./_global":"kql1"}],viv7:[function(e,t,i){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],sbFn:[function(e,t,i){var r,n,a,s=e("./_ctx"),o=e("./_invoke"),u=e("./_html"),l=e("./_dom-create"),c=e("./_global"),h=c.process,m=c.setImmediate,_=c.clearImmediate,d=c.MessageChannel,f=c.Dispatch,p=0,g={},b="onreadystatechange",M=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){M.call(e.data)};m&&_||(m=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return g[++p]=function(){o("function"==typeof e?e:Function(e),t)},r(p),p},_=function(e){delete g[e]},"process"==e("./_cof")(h)?r=function(e){h.nextTick(s(M,e,1))}:f&&f.now?r=function(e){f.now(s(M,e,1))}:d?(a=(n=new d).port2,n.port1.onmessage=y,r=s(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):r=b in l("script")?function(e){u.appendChild(l("script"))[b]=function(){u.removeChild(this),M.call(e)}}:function(e){setTimeout(s(M,e,1),0)}),t.exports={set:m,clear:_}},{"./_ctx":"N9ch","./_invoke":"TTev","./_html":"DBa9","./_dom-create":"dDni","./_global":"kql1","./_cof":"viv7"}],hg3C:[function(e,t,i){var r=e("./_export"),n=e("./_task");r(r.G+r.B,{setImmediate:n.set,clearImmediate:n.clear})},{"./_export":"NjVL","./_task":"sbFn"}],lYxK:[function(e,t,i){e("../modules/web.immediate"),t.exports=e("../modules/_core").setImmediate},{"../modules/web.immediate":"hg3C","../modules/_core":"KVo1"}],oYDs:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.buildPaletteSync=function(e,{colorDistanceFormula:t,paletteQuantization:i,colors:r}={}){const n=h(l(t),i,r);return e.forEach(e=>n.sample(e)),n.quantizeSync()},i.buildPalette=async function(e,{colorDistanceFormula:t,paletteQuantization:i,colors:n,onProgress:a}={}){return new Promise((s,o)=>{const u=h(l(t),i,n);let c,m;e.forEach(e=>u.sample(e));const _=u.quantize(),d=()=>{try{const t=_.next();t.done?s(c):(t.value.palette&&(c=t.value.palette),a&&a(t.value.progress),m=r(d))}catch(e){clearTimeout(m),o(e)}};m=r(d)})},i.applyPaletteSync=function(e,t,{colorDistanceFormula:i,imageQuantization:r}={}){return c(l(i),r).quantizeSync(e,t)},i.applyPalette=async function(e,t,{colorDistanceFormula:i,imageQuantization:n,onProgress:a}={}){return new Promise((s,o)=>{let u,h;const m=c(l(i),n).quantize(e,t),_=()=>{try{const t=m.next();t.done?s(u):(t.value.pointContainer&&(u=t.value.pointContainer),a&&a(t.value.progress),h=r(_))}catch(e){clearTimeout(h),o(e)}};h=r(_)})};var r=u(e("core-js/fn/set-immediate")),n=u(e("./distance")),a=u(e("./image")),s=u(e("./palette"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}function l(e="euclidean-bt709"){switch(e){case"cie94-graphic-arts":return new n.CIE94GraphicArts;case"cie94-textiles":return new n.CIE94Textiles;case"ciede2000":return new n.CIEDE2000;case"color-metric":return new n.CMetric;case"euclidean":return new n.Euclidean;case"euclidean-bt709":return new n.EuclideanBT709;case"euclidean-bt709-noalpha":return new n.EuclideanBT709NoAlpha;case"manhattan":return new n.Manhattan;case"manhattan-bt709":return new n.ManhattanBT709;case"manhattan-nommyde":return new n.ManhattanNommyde;case"pngquant":return new n.PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${e}`)}}function c(e,t="floyd-steinberg"){switch(t){case"nearest":return new a.NearestColor(e);case"riemersma":return new a.ErrorDiffusionRiemersma(e);case"floyd-steinberg":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.FloydSteinberg);case"false-floyd-steinberg":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.FalseFloydSteinberg);case"stucki":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.Stucki);case"atkinson":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.Atkinson);case"jarvis":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.Jarvis);case"burkes":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.Burkes);case"sierra":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.Sierra);case"two-sierra":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.TwoSierra);case"sierra-lite":return new a.ErrorDiffusionArray(e,a.ErrorDiffusionArrayKernel.SierraLite);default:throw new Error(`Unknown imageQuantization ${t}`)}}function h(e,t="wuquant",i=256){switch(t){case"neuquant":return new s.NeuQuant(e,i);case"rgbquant":return new s.RGBQuant(e,i);case"wuquant":return new s.WuQuant(e,i);case"neuquant-float":return new s.NeuQuantFloat(e,i);default:throw new Error(`Unknown paletteQuantization ${t}`)}}},{"core-js/fn/set-immediate":"lYxK","./distance":"a183","./image":"d99G","./palette":"usjm"}],Eoc4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"buildPalette",{enumerable:!0,get:function(){return c.buildPalette}}),Object.defineProperty(i,"buildPaletteSync",{enumerable:!0,get:function(){return c.buildPaletteSync}}),Object.defineProperty(i,"applyPalette",{enumerable:!0,get:function(){return c.applyPalette}}),Object.defineProperty(i,"applyPaletteSync",{enumerable:!0,get:function(){return c.applyPaletteSync}}),i.utils=i.quality=i.image=i.palette=i.distance=i.conversion=i.constants=void 0;var r=m(e("./constants"));i.constants=r;var n=m(e("./conversion"));i.conversion=n;var a=m(e("./distance"));i.distance=a;var s=m(e("./palette"));i.palette=s;var o=m(e("./image"));i.image=o;var u=m(e("./quality"));i.quality=u;var l=m(e("./utils"));i.utils=l;var c=e("./basicAPI");function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function m(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}},{"./constants":"TlpJ","./conversion":"T7GD","./distance":"a183","./palette":"usjm","./image":"d99G","./quality":"yZRa","./utils":"MRhM","./basicAPI":"oYDs"}],qPOO:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t){return function(e,t){for(var i=0,r=0;r<e.data.length;++r){var n=Math.abs(e.data[r]/255-t.data[r]/255);i+=n*n}return i}(e,t)}},{}],PDIj:[function(e,t,i){"use strict";function r(e,t){e.fillStyle=function(e){if(e.length>0)return"#"+e[Math.floor(Math.random()*e.length)].toString(16).substr(2,6);for(var t="#",i=0;i<6;i++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}(t);var i=Math.random()*e.canvas.width,r=Math.random()*e.canvas.height,n=Math.random()*e.canvas.width*.125,a=Math.random()*e.canvas.height*.125,s=Math.random()*Math.PI;e.beginPath(),e.ellipse(i,r,n,a,s,0,2*Math.PI),e.fill()}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t){var i=e.getContext("2d");return Math.random(),r(i,t),i.getImageData(0,0,e.width,e.height)}},{}],B6dB:[function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0});var n=e("image-q"),a=r(e("./comparator")),s=r(e("./brush"));new(function(){function e(){this.palette=new Uint32Array(0),this.similarity=Number.MAX_VALUE,this.image1=document.createElement("canvas"),this.imageTemp=document.createElement("canvas"),this.image2=document.createElement("canvas"),document.body.appendChild(this.image1),document.body.appendChild(this.image2),this.srcimg=new Image,this.srcimg.setAttribute("crossOrigin",""),this.srcimg.onload=this.start.bind(this),this.srcimg.src="https://upload.wikimedia.org/wikipedia/commons/7/71/Grant_DeVolson_Wood_-_American_Gothic.jpg",this.sourcePixels=this.image2.getContext("2d").createImageData(this.image2.width,this.image2.height)}return e.prototype.start=function(){var e="200px",t=200/(this.srcimg.naturalWidth/this.srcimg.naturalHeight)+"px";this.image1.style.width=e,this.image1.style.height=t,this.imageTemp.style.width=e,this.imageTemp.style.height=t,this.image2.style.width=e,this.image2.style.height=t;var i=this.image2.getContext("2d");i.drawImage(this.srcimg,0,0,this.srcimg.naturalWidth,this.srcimg.naturalHeight,0,0,this.image2.width,this.image2.height),this.sourcePixels=i.getImageData(0,0,this.image2.width,this.image2.height);var r=n.utils.PointContainer.fromUint8Array(this.sourcePixels.data,this.sourcePixels.width,this.sourcePixels.height),a=n.buildPaletteSync([r],{colorDistanceFormula:"euclidean",paletteQuantization:"neuquant",colors:256});this.palette=a.getPointContainer().toUint32Array(),this.iterate()},e.prototype.iterate=function(){var e=s.default(this.imageTemp,this.palette),t=a.default(e,this.sourcePixels);t<this.similarity?(this.similarity=t,this.image1.getContext("2d").drawImage(this.imageTemp,0,0)):this.imageTemp.getContext("2d").drawImage(this.image1,0,0),this.similarity>.1?setTimeout(this.iterate.bind(this),0):console.log("THRESHOLD ACHIEVED!!!!!")},e}())},{"image-q":"Eoc4","./comparator":"qPOO","./brush":"PDIj"}]},{},["B6dB"])},{}]},{},["YKZR"]);
},{}]},{},["L3xk"], null)
//# sourceMappingURL=dist/src.074b50b6.3b708599.b711b365.js.map