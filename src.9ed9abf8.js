parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"ArXC":[function(require,module,exports) {
"use strict";function e(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}function t(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),s=e.a,a=Math.round(e.h),l=e.s.toFixed(1),d=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+s+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+s+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+a+",s:"+l+",v:"+d+"}":"HSVA_OBJ"===n?"{h:"+a+",s:"+l+",v:"+d+",a:"+s+"}":"unknown format"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GUI=exports.gui=exports.dom=exports.controllers=exports.color=void 0;var n=Array.prototype.forEach,o=Array.prototype.slice,i={BREAK:{},extend:function(e){return this.each(o.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(o.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=o.call(arguments);return function(){for(var t=o.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,o){if(e)if(n&&e.forEach&&e.forEach===n)e.forEach(t,o);else if(e.length===e.length+0){var i,r=void 0;for(r=0,i=e.length;r<i;r++)if(r in e&&t.call(o,e[r],r)===this.BREAK)return}else for(var s in e)if(t.call(o,e[s],s)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var o=void 0;return function(){var i=this,r=arguments;var s=n||!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(i,r)},t),s&&e.apply(i,r)}},toArray:function(e){return e.toArray?e.toArray():o.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},r=[{litmus:i.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:t},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:t},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:t},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:t}}},{litmus:i.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:i.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:i.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(i.isNumber(e.r)&&i.isNumber(e.g)&&i.isNumber(e.b)&&i.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(i.isNumber(e.r)&&i.isNumber(e.g)&&i.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(i.isNumber(e.h)&&i.isNumber(e.s)&&i.isNumber(e.v)&&i.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(i.isNumber(e.h)&&i.isNumber(e.s)&&i.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],s=void 0,a=void 0,l=function(){a=!1;var e=arguments.length>1?i.toArray(arguments):arguments[0];return i.each(r,function(t){if(t.litmus(e))return i.each(t.conversions,function(t,n){if(s=t.read(e),!1===a&&!1!==s)return a=s,s.conversionName=n,s.conversion=t,i.BREAK}),i.BREAK}),a},d=void 0,c={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),s=n*(1-i*t),a=n*(1-(1-i)*t),l=[[n,a,r],[s,n,r],[r,n,a],[r,s,n],[a,r,n],[n,r,s]][o];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(s/=6)<0&&(s+=1),{h:360*s,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){var o=this.hex_with_component(0,2,e);return o=this.hex_with_component(o,1,t),o=this.hex_with_component(o,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(d=8*t)|e&~(255<<d)}},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(o):void 0},f=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},m=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},g=function(){function e(){if(_(this,e),this.__state=l.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return h(e,[{key:"toString",value:function(){return t(this)}},{key:"toHexString",value:function(){return t(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function b(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(g.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(g.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function v(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(g.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(g.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}g.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=c.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");i.extend(e.__state,c.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},g.recalculateHSV=function(e){var t=c.rgb_to_hsv(e.r,e.g,e.b);i.extend(e.__state,{s:t.s,v:t.v}),i.isNaN(t.h)?i.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},g.COMPONENTS=["r","g","b","h","s","v","hex","a"],b(g.prototype,"r",2),b(g.prototype,"g",1),b(g.prototype,"b",0),v(g.prototype,"h"),v(g.prototype,"s"),v(g.prototype,"v"),Object.defineProperty(g.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(g.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=c.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var y=function(){function e(t,n){_(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return h(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),w={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},x={};i.each(w,function(e,t){i.each(e,function(e){x[e]=t})});var E=/(\d+(\.\d+)?)px/;function C(e){if("0"===e||i.isUndefined(e))return 0;var t=e.match(E);return i.isNull(t)?0:parseFloat(t[1])}var A={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var o=n,r=t;i.isUndefined(r)&&(r=!0),i.isUndefined(o)&&(o=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var r=n||{},s=x[t];if(!s)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(s);switch(s){case"MouseEvents":var l=r.x||r.clientX||0,d=r.y||r.clientY||0;a.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,l,d,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;i.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(t,r.bubbles||!1,r.cancelable||!0)}i.defaults(a,o),e.dispatchEvent(a)},bind:function(e,t,n,o){var i=o||!1;return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),A},unbind:function(e,t,n,o){var i=o||!1;return e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n),A},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return A},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!==o&&(n.splice(o,1),e.className=n.join(" "))}else e.className=void 0;return A},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return C(t["border-left-width"])+C(t["border-right-width"])+C(t["padding-left"])+C(t["padding-right"])+C(t.width)},getHeight:function(e){var t=getComputedStyle(e);return C(t["border-top-width"])+C(t["border-bottom-width"])+C(t["padding-top"])+C(t["padding-bottom"])+C(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},k=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),A.bind(o.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),S=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o,a=r;if(r.__select=document.createElement("select"),i.isArray(s)){var l={};i.each(s,function(e){l[e]=e}),s=l}return i.each(s,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),r.updateDisplay(),A.bind(r.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),r.domElement.appendChild(r.__select),r}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return A.isActive(this.__select)?this:(this.__select.value=this.getValue(),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),O=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;function r(){i.setValue(i.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),A.bind(o.__input,"keyup",r),A.bind(o.__input,"change",r),A.bind(o.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),A.bind(o.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return f(t,y),h(t,[{key:"updateDisplay",value:function(){return A.isActive(this.__input)||(this.__input.value=this.getValue()),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function T(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var L=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o||{};return r.__min=s.min,r.__max=s.max,r.__step=s.step,i.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=T(r.__impliedStep),r}return f(t,y),h(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=T(e),this}}]),t}();function R(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var B=function(e){function t(e,n,o){_(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));r.__truncationSuspended=!1;var s=r,a=void 0;function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function d(e){var t=a-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),a=e.clientY}function c(){A.unbind(window,"mousemove",d),A.unbind(window,"mouseup",c),l()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),A.bind(r.__input,"change",function(){var e=parseFloat(s.__input.value);i.isNaN(e)||s.setValue(e)}),A.bind(r.__input,"blur",function(){l()}),A.bind(r.__input,"mousedown",function(e){A.bind(window,"mousemove",d),A.bind(window,"mouseup",c),a=e.clientY}),A.bind(r.__input,"keydown",function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,l())}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return f(t,L),h(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():R(this.getValue(),this.__precision),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function N(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var H=function(e){function t(e,n,o,i,r){_(this,t);var s=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:o,max:i,step:r})),a=s;function l(e){e.preventDefault();var t=a.__background.getBoundingClientRect();return a.setValue(N(e.clientX,t.left,t.right,a.__min,a.__max)),!1}function d(){A.unbind(window,"mousemove",l),A.unbind(window,"mouseup",d),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(e){var t=e.touches[0].clientX,n=a.__background.getBoundingClientRect();a.setValue(N(t,n.left,n.right,a.__min,a.__max))}function u(){A.unbind(window,"touchmove",c),A.unbind(window,"touchend",u),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),A.bind(s.__background,"mousedown",function(e){document.activeElement.blur(),A.bind(window,"mousemove",l),A.bind(window,"mouseup",d),l(e)}),A.bind(s.__background,"touchstart",function(e){if(1!==e.touches.length)return;A.bind(window,"touchmove",c),A.bind(window,"touchend",u),c(e)}),A.addClass(s.__background,"slider"),A.addClass(s.__foreground,"slider-fg"),s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return f(t,L),h(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),F=function(e){function t(e,n,o){_(this,t);var i=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===o?"Fire":o,A.bind(i.__button,"click",function(e){return e.preventDefault(),r.fire(),!1}),A.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return f(t,y),h(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),P=function(e){function t(e,n){_(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.__color=new g(o.getValue()),o.__temp=new g(0);var r=o;o.domElement=document.createElement("div"),A.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",A.bind(o.__input,"keydown",function(e){13===e.keyCode&&h.call(this)}),A.bind(o.__input,"blur",h),A.bind(o.__selector,"mousedown",function(){A.addClass(this,"drag").bind(window,"mouseup",function(){A.removeClass(r.__selector,"drag")})}),A.bind(o.__selector,"touchstart",function(){A.addClass(this,"drag").bind(window,"touchend",function(){A.removeClass(r.__selector,"drag")})});var s=document.createElement("div");function a(e){f(e),A.bind(window,"mousemove",f),A.bind(window,"touchmove",f),A.bind(window,"mouseup",c),A.bind(window,"touchend",c)}function d(e){b(e),A.bind(window,"mousemove",b),A.bind(window,"touchmove",b),A.bind(window,"mouseup",u),A.bind(window,"touchend",u)}function c(){A.unbind(window,"mousemove",f),A.unbind(window,"touchmove",f),A.unbind(window,"mouseup",c),A.unbind(window,"touchend",c),p()}function u(){A.unbind(window,"mousemove",b),A.unbind(window,"touchmove",b),A.unbind(window,"mouseup",u),A.unbind(window,"touchend",u),p()}function h(){var e=l(this.value);!1!==e?(r.__color.__state=e,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function p(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,o=n.clientX,i=n.clientY,s=(o-t.left)/(t.right-t.left),a=1-(i-t.top)/(t.bottom-t.top);return a>1?a=1:a<0&&(a=0),s>1?s=1:s<0&&(s=0),r.__color.v=a,r.__color.s=s,r.setValue(r.__color.toOriginal()),!1}function b(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),r.__color.h=360*n,r.setValue(r.__color.toOriginal()),!1}return i.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(s.style,{width:"100%",height:"100%",background:"none"}),j(s,"top","rgba(0,0,0,0)","#000"),i.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),V(o.__hue_field),i.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),A.bind(o.__saturation_field,"mousedown",a),A.bind(o.__saturation_field,"touchstart",a),A.bind(o.__field_knob,"mousedown",a),A.bind(o.__field_knob,"touchstart",a),A.bind(o.__hue_field,"mousedown",d),A.bind(o.__hue_field,"touchstart",d),o.__saturation_field.appendChild(s),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return f(t,y),h(t,[{key:"updateDisplay",value:function(){var e=l(this.getValue());if(!1!==e){var t=!1;i.each(g.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,o=255-n;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,j(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),i.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(),D=["-moz-","-o-","-webkit-","-ms-",""];function j(e,t,n,o){e.style.background="",i.each(D,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+o+" 100%); "})}function V(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var I={load:function(e,t){var n=t||document,o=n.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,n.getElementsByTagName("head")[0].appendChild(o)},inject:function(e,t){var n=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var i=n.getElementsByTagName("head")[0];try{i.appendChild(o)}catch(r){}}},z='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',M=function(e,t){var n=e[t];return i.isArray(arguments[2])||i.isObject(arguments[2])?new S(e,t,arguments[2]):i.isNumber(n)?i.isNumber(arguments[2])&&i.isNumber(arguments[3])?i.isNumber(arguments[4])?new H(e,t,arguments[2],arguments[3],arguments[4]):new H(e,t,arguments[2],arguments[3]):i.isNumber(arguments[4])?new B(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new B(e,t,{min:arguments[2],max:arguments[3]}):i.isString(n)?new O(e,t):i.isFunction(n)?new F(e,t,""):i.isBoolean(n)?new k(e,t):null};function G(e){setTimeout(e,1e3/60)}var U=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||G,X=function(){function e(){_(this,e),this.backgroundElement=document.createElement("div"),i.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),A.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),i.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;A.bind(this.backgroundElement,"click",function(){t.hide()})}return h(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),i.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",A.unbind(e.domElement,"webkitTransitionEnd",t),A.unbind(e.domElement,"transitionend",t),A.unbind(e.domElement,"oTransitionEnd",t)};A.bind(this.domElement,"webkitTransitionEnd",t),A.bind(this.domElement,"transitionend",t),A.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-A.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-A.getHeight(this.domElement)/2+"px"}}]),e}(),K=e(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");I.inject(K);var Y="dg",J=72,W=20,Q="Default",q=function(){try{return!!window.localStorage}catch(e){return!1}}(),Z=void 0,$=!0,ee=void 0,te=!1,ne=[],oe=function e(t){var n=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),A.addClass(this.domElement,Y),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=i.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=i.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),i.isUndefined(o.load)?o.load={preset:Q}:o.preset&&(o.load.preset=o.preset),i.isUndefined(o.parent)&&o.hideable&&ne.push(this),o.resizable=i.isUndefined(o.parent)&&o.resizable,o.autoPlace&&i.isUndefined(o.scrollable)&&(o.scrollable=!0);var r,s=q&&"true"===localStorage.getItem(ce(this,"isLocal")),a=void 0,l=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,ge(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,fe(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,l&&(l.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?A.addClass(n.__ul,e.CLASS_CLOSED):A.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return s},set:function(e){q&&(s=e,e?A.bind(window,"unload",a):A.unbind(window,"unload",a),localStorage.setItem(ce(n,"isLocal"),e))}}}),i.isUndefined(o.parent)){if(this.closed=o.closed||!1,A.addClass(this.domElement,e.CLASS_MAIN),A.makeSelectable(this.domElement,!1),q&&s){n.useLocalStorage=!0;var d=localStorage.getItem(ce(this,"gui"));d&&(o.load=JSON.parse(d))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,A.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(A.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(A.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),A.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===o.closed&&(o.closed=!0);var c=document.createTextNode(o.name);A.addClass(c,"controller-name"),l=ie(n,c);A.addClass(this.__ul,e.CLASS_CLOSED),A.addClass(l,"title"),A.bind(l,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)}o.autoPlace&&(i.isUndefined(o.parent)&&($&&(ee=document.createElement("div"),A.addClass(ee,Y),A.addClass(ee,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ee),$=!1),ee.appendChild(this.domElement),A.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||fe(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},A.bind(window,"resize",this.__resizeHandler),A.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),A.bind(this.__ul,"transitionend",this.__resizeHandler),A.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&pe(this),a=function(){q&&"true"===localStorage.getItem(ce(n,"isLocal"))&&localStorage.setItem(ce(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,o.parent||((r=n.getRoot()).width+=1,i.defer(function(){r.width-=1}))};function ie(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function re(e){A.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&A.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function se(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function ae(e,t,n){if(n.__li=t,n.__gui=e,i.extend(n,{options:function(t){if(arguments.length>1){var o=n.__li.nextElementSibling;return n.remove(),de(e,n.object,n.property,{before:o,factoryArgs:[i.toArray(arguments)]})}if(i.isArray(t)||i.isObject(t)){var r=n.__li.nextElementSibling;return n.remove(),de(e,n.object,n.property,{before:r,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof H){var o=new B(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});i.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=n[e],i=o[e];n[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(o,e),t.apply(n,e)}}),A.addClass(t,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof B){var r=function(t){if(i.isNumber(n.__min)&&i.isNumber(n.__max)){var o=n.__li.firstElementChild.firstElementChild.innerHTML,r=n.__gui.__listening.indexOf(n)>-1;n.remove();var s=de(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return s.name(o),r&&s.listen(),s}return t};n.min=i.compose(r,n.min),n.max=i.compose(r,n.max)}else n instanceof k?(A.bind(t,"click",function(){A.fakeEvent(n.__checkbox,"click")}),A.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof F?(A.bind(t,"click",function(){A.fakeEvent(n.__button,"click")}),A.bind(t,"mouseover",function(){A.addClass(n.__button,"hover")}),A.bind(t,"mouseout",function(){A.removeClass(n.__button,"hover")})):n instanceof P&&(A.addClass(t,"color"),n.updateDisplay=i.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=i.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&se(e.getRoot(),!0),t},n.setValue)}function le(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){var r=n.load.remembered,s=void 0;if(r[e.preset])s=r[e.preset];else{if(!r[Q])return;s=r[Q]}if(s[o]&&void 0!==s[o][t.property]){var a=s[o][t.property];t.initialValue=a,t.setValue(a)}}}}function de(e,t,n,o){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var i=void 0;if(o.color)i=new P(t,n);else{var r=[t,n].concat(o.factoryArgs);i=M.apply(e,r)}o.before instanceof y&&(o.before=o.before.__li),le(e,i),A.addClass(i.domElement,"c");var s=document.createElement("span");A.addClass(s,"property-name"),s.innerHTML=i.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(i.domElement);var l=ie(e,a,o.before);return A.addClass(l,oe.CLASS_CONTROLLER_ROW),i instanceof P?A.addClass(l,"color"):A.addClass(l,u(i.getValue())),ae(e,l,i),e.__controllers.push(i),i}function ce(e,t){return document.location.href+"."+t}function ue(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function _e(e,t){t.style.display=e.useLocalStorage?"block":"none"}function he(e){var t=e.__save_row=document.createElement("li");A.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),A.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",A.addClass(n,"button gears");var o=document.createElement("span");o.innerHTML="Save",A.addClass(o,"button"),A.addClass(o,"save");var r=document.createElement("span");r.innerHTML="New",A.addClass(r,"button"),A.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",A.addClass(s,"button"),A.addClass(s,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?i.each(e.load.remembered,function(t,n){ue(e,n,n===e.preset)}):ue(e,Q,!1),A.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(s),q){var l=document.getElementById("dg-local-explain"),d=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(ce(e,"isLocal"))&&d.setAttribute("checked","checked"),_e(e,l),A.bind(d,"change",function(){e.useLocalStorage=!e.useLocalStorage,_e(e,l)})}var c=document.getElementById("dg-new-constructor");A.bind(c,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||Z.hide()}),A.bind(n,"click",function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),Z.show(),c.focus(),c.select()}),A.bind(o,"click",function(){e.save()}),A.bind(r,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),A.bind(s,"click",function(){e.revert()})}function pe(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){A.removeClass(e.__closeButton,oe.CLASS_DRAG),A.unbind(window,"mousemove",n),A.unbind(window,"mouseup",o)}function r(i){return i.preventDefault(),t=i.clientX,A.addClass(e.__closeButton,oe.CLASS_DRAG),A.bind(window,"mousemove",n),A.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),i.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),A.bind(e.__resize_handle,"mousedown",r),A.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function fe(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function me(e,t){var n={};return i.each(e.__rememberedObjects,function(o,r){var s={},a=e.__rememberedObjectIndecesToControllers[r];i.each(a,function(e,n){s[n]=t?e.initialValue:e.getValue()}),n[r]=s}),n}function ge(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function be(e){0!==e.length&&U.call(window,function(){be(e)}),i.each(e,function(e){e.updateDisplay()})}oe.toggleHide=function(){te=!te,i.each(ne,function(e){e.domElement.style.display=te?"none":""})},oe.CLASS_AUTO_PLACE="a",oe.CLASS_AUTO_PLACE_CONTAINER="ac",oe.CLASS_MAIN="main",oe.CLASS_CONTROLLER_ROW="cr",oe.CLASS_TOO_TALL="taller-than-window",oe.CLASS_CLOSED="closed",oe.CLASS_CLOSE_BUTTON="close-button",oe.CLASS_CLOSE_TOP="close-top",oe.CLASS_CLOSE_BOTTOM="close-bottom",oe.CLASS_DRAG="drag",oe.DEFAULT_WIDTH=245,oe.TEXT_CLOSED="Close Controls",oe.TEXT_OPEN="Open Controls",oe._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==J&&e.keyCode!==J||oe.toggleHide()},A.bind(window,"keydown",oe._keydownHandler,!1),i.extend(oe.prototype,{add:function(e,t){return de(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return de(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;i.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ee.removeChild(this.domElement);var e=this;i.each(this.__folders,function(t){e.removeFolder(t)}),A.unbind(window,"keydown",oe._keydownHandler,!1),re(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new oe(t);this.__folders[e]=n;var o=ie(this,n.domElement);return A.addClass(o,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],re(e);var t=this;i.each(e.__folders,function(t){e.removeFolder(t)}),i.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=A.getOffset(e.__ul).top,n=0;i.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=A.getHeight(t))}),window.innerHeight-t-W<n?(A.addClass(e.domElement,oe.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-W+"px"):(A.removeClass(e.domElement,oe.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&i.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:i.debounce(function(){this.onResize()},50),remember:function(){if(i.isUndefined(Z)&&((Z=new X).domElement.innerHTML=z),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;i.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&he(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&fe(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=me(this)),e.folders={},i.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=me(this),se(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Q]=me(this,!0)),this.load.remembered[e]=me(this),this.preset=e,ue(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){i.each(this.__controllers,function(t){this.getRoot().load.remembered?le(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),i.each(this.__folders,function(e){e.revert(e)}),e||se(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&be(this.__listening)},updateDisplay:function(){i.each(this.__controllers,function(e){e.updateDisplay()}),i.each(this.__folders,function(e){e.updateDisplay()})}});var ve={Color:g,math:c,interpret:l};exports.color=ve;var ye={Controller:y,BooleanController:k,OptionController:S,StringController:O,NumberController:L,NumberControllerBox:B,NumberControllerSlider:H,FunctionController:F,ColorController:P};exports.controllers=ye;var we={dom:A};exports.dom=we;var xe={GUI:oe};exports.gui=xe;var Ee=oe;exports.GUI=Ee;var Ce={color:ve,controllers:ye,dom:we,gui:xe,GUI:Ee},Ae=Ce;exports.default=Ae;
},{}],"Spxq":[function(require,module,exports) {
"use strict";var E,e,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.y=exports.x=exports.Y=void 0,exports.Y=E,function(E){E[E.RED=.2126]="RED",E[E.GREEN=.7152]="GREEN",E[E.BLUE=.0722]="BLUE",E[E.WHITE=1]="WHITE"}(E||(exports.Y=E={})),exports.x=e,function(E){E[E.RED=.64]="RED",E[E.GREEN=.3]="GREEN",E[E.BLUE=.15]="BLUE",E[E.WHITE=.3127]="WHITE"}(e||(exports.x=e={})),exports.y=t,function(E){E[E.RED=.33]="RED",E[E.GREEN=.6]="GREEN",E[E.BLUE=.06]="BLUE",E[E.WHITE=.329]="WHITE"}(t||(exports.y=t={}));
},{}],"TlpJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bt709=void 0;var e=r(require("./bt709"));function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t();if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var f=o?Object.getOwnPropertyDescriptor(e,u):null;f&&(f.get||f.set)?Object.defineProperty(n,u,f):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}exports.bt709=e;
},{"./bt709":"Spxq"}],"pYSN":[function(require,module,exports) {
"use strict";function e(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}function t(t,r,n){return{x:.4124*(t=e(t/255))+.3576*(r=e(r/255))+.1805*(n=e(n/255)),y:.2126*t+.7152*r+.0722*n,z:.0193*t+.1192*r+.9505*n}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rgb2xyz=t;
},{}],"b3mL":[function(require,module,exports) {
"use strict";function t(t){return t*(Math.PI/180)}function n(t,n,e){let r=t;return r<n&&(r=n),r<e&&(r=e),r}function e(t,n,e){let r=t;return r>n&&(r=n),r>e&&(r=e),r}function r(t,n,e){return t>e&&(t=e),t<n&&(t=n),0|t}function o(t){return(t=Math.round(t))>255?t=255:t<0&&(t=0),t}function u(t){return t>255?t=255:t<0&&(t=0),t}function s(t,n){const e=typeof t[0];let r;if("number"===e||"string"===e){const e=Object.create(null);for(let n=0,r=t.length;n<r;n++){const r=t[n];e[r]||0===e[r]||(e[r]=n)}r=t.sort(function(t,r){return n(t,r)||e[t]-e[r]})}else{const e=t.slice(0);r=t.sort(function(t,r){return n(t,r)||e.indexOf(t)-e.indexOf(r)})}return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.degrees2radians=t,exports.max3=n,exports.min3=e,exports.intInRange=r,exports.inRange0to255Rounded=o,exports.inRange0to255=u,exports.stableSort=s;
},{}],"RhPC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.rgb2hsl=t;var e=require("../utils/arithmetic");function t(t,r,s){const i=(0,e.min3)(t,r,s),l=(0,e.max3)(t,r,s),u=l-i,n=(i+l)/510;let o=0;n>0&&n<1&&(o=u/(n<.5?l+i:510-l-i));let c=0;return u>0&&(c=l===t?(r-s)/u:l===r?2+(s-t)/u:4+(t-r)/u,(c*=60)<0&&(c+=360)),{h:c,s:o,l:n}}
},{"../utils/arithmetic":"b3mL"}],"dYwZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.xyz2lab=n;const t=.95047,e=1,r=1.08883;function o(t){return t>.008856?Math.pow(t,1/3):7.787*t+16/116}function n(n,u,x){if(n=o(n/t),u=o(u/e),x=o(x/r),116*u-16<0)throw new Error("xxx");return{L:Math.max(0,116*u-16),a:500*(n-u),b:200*(u-x)}}
},{}],"mK7q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.rgb2lab=t;var e=require("./rgb2xyz"),r=require("./xyz2lab");function t(t,b,u){const x=(0,e.rgb2xyz)(t,b,u);return(0,r.xyz2lab)(x.x,x.y,x.z)}
},{"./rgb2xyz":"pYSN","./xyz2lab":"dYwZ"}],"OfSb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lab2xyz=r;const t=.95047,e=1,n=1.08883;function o(t){return t>.206893034?Math.pow(t,3):(t-16/116)/7.787}function r(r,s,u){const c=(r+16)/116,i=c-u/200;return{x:t*o(s/500+c),y:e*o(c),z:n*o(i)}}
},{}],"RJ9n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.xyz2rgb=n;var e=require("../utils/arithmetic");function t(e){return e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e}function n(n,r,o){const u=t(3.2406*n+-1.5372*r+-.4986*o),i=t(-.9689*n+1.8758*r+.0415*o),d=t(.0557*n+-.204*r+1.057*o);return{r:(0,e.inRange0to255Rounded)(255*u),g:(0,e.inRange0to255Rounded)(255*i),b:(0,e.inRange0to255Rounded)(255*d)}}
},{"../utils/arithmetic":"b3mL"}],"RhbY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lab2rgb=t;var e=require("./lab2xyz"),r=require("./xyz2rgb");function t(t,b,u){const x=(0,e.lab2xyz)(t,b,u);return(0,r.xyz2rgb)(x.x,x.y,x.z)}
},{"./lab2xyz":"OfSb","./xyz2rgb":"RJ9n"}],"T7GD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"rgb2xyz",{enumerable:!0,get:function(){return e.rgb2xyz}}),Object.defineProperty(exports,"rgb2hsl",{enumerable:!0,get:function(){return r.rgb2hsl}}),Object.defineProperty(exports,"rgb2lab",{enumerable:!0,get:function(){return t.rgb2lab}}),Object.defineProperty(exports,"lab2xyz",{enumerable:!0,get:function(){return b.lab2xyz}}),Object.defineProperty(exports,"lab2rgb",{enumerable:!0,get:function(){return n.lab2rgb}}),Object.defineProperty(exports,"xyz2lab",{enumerable:!0,get:function(){return u.xyz2lab}}),Object.defineProperty(exports,"xyz2rgb",{enumerable:!0,get:function(){return l.xyz2rgb}});var e=require("./rgb2xyz"),r=require("./rgb2hsl"),t=require("./rgb2lab"),b=require("./lab2xyz"),n=require("./lab2rgb"),u=require("./xyz2lab"),l=require("./xyz2rgb");
},{"./rgb2xyz":"pYSN","./rgb2hsl":"RhPC","./rgb2lab":"mK7q","./lab2xyz":"OfSb","./lab2rgb":"RhbY","./xyz2lab":"dYwZ","./xyz2rgb":"RJ9n"}],"rtya":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractDistanceCalculator=void 0;class t{constructor(){this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(t,a,e,s){this._whitePoint={r:t>0?255/t:0,g:a>0?255/a:0,b:e>0?255/e:0,a:s>0?255/s:0},this._maxDistance=this.calculateRaw(t,a,e,s,0,0,0,0)}calculateNormalized(t,a){return this.calculateRaw(t.r,t.g,t.b,t.a,a.r,a.g,a.b,a.a)/this._maxDistance}}exports.AbstractDistanceCalculator=t;
},{}],"MS9V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CIE94GraphicArts=exports.CIE94Textiles=exports.AbstractCIE94=void 0;var t=require("./distanceCalculator"),s=require("../conversion/rgb2lab"),e=require("../utils/arithmetic");class i extends t.AbstractDistanceCalculator{calculateRaw(t,i,a,r,h,o,n,l){const _=(0,s.rgb2lab)((0,e.inRange0to255)(t*this._whitePoint.r),(0,e.inRange0to255)(i*this._whitePoint.g),(0,e.inRange0to255)(a*this._whitePoint.b)),c=(0,s.rgb2lab)((0,e.inRange0to255)(h*this._whitePoint.r),(0,e.inRange0to255)(o*this._whitePoint.g),(0,e.inRange0to255)(n*this._whitePoint.b)),b=_.L-c.L,p=_.a-c.a,u=_.b-c.b,w=Math.sqrt(_.a*_.a+_.b*_.b),x=w-Math.sqrt(c.a*c.a+c.b*c.b);let g=p*p+u*u-x*x;g=g<0?0:Math.sqrt(g);const K=(l-r)*this._whitePoint.a*this._kA;return Math.sqrt(Math.pow(b/this._Kl,2)+Math.pow(x/(1+this._K1*w),2)+Math.pow(g/(1+this._K2*w),2)+Math.pow(K,2))}}exports.AbstractCIE94=i;class a extends i{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}}exports.CIE94Textiles=a;class r extends i{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}}exports.CIE94GraphicArts=r;
},{"./distanceCalculator":"rtya","../conversion/rgb2lab":"mK7q","../utils/arithmetic":"b3mL"}],"oVGY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CIEDE2000=void 0;var a=require("./distanceCalculator"),t=require("../conversion/rgb2lab"),e=require("../utils/arithmetic");class n extends a.AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(a,t){const e=Math.atan2(a,t);return e>=0?e:e+n._deg360InRad}static _calculateRT(a,t){const e=Math.pow(t,7),s=2*Math.sqrt(e/(e+n._pow25to7)),d=n._deg30InRad*Math.exp(-Math.pow((a-n._deg275InRad)/n._deg25InRad,2));return-Math.sin(2*d)*s}static _calculateT(a){return 1-.17*Math.cos(a-n._deg30InRad)+.24*Math.cos(2*a)+.32*Math.cos(3*a+n._deg6InRad)-.2*Math.cos(4*a-n._deg63InRad)}static _calculate_ahp(a,t,e,s){const d=e+s;return 0===a?d:t<=n._deg180InRad?d/2:d<n._deg360InRad?(d+n._deg360InRad)/2:(d-n._deg360InRad)/2}static _calculate_dHp(a,t,e,s){let d;return d=0===a?0:t<=n._deg180InRad?e-s:e<=s?e-s+n._deg360InRad:e-s-n._deg360InRad,2*Math.sqrt(a)*Math.sin(d/2)}calculateRaw(a,s,d,r,i,c,_,h){const o=(0,t.rgb2lab)((0,e.inRange0to255)(a*this._whitePoint.r),(0,e.inRange0to255)(s*this._whitePoint.g),(0,e.inRange0to255)(d*this._whitePoint.b)),l=(0,t.rgb2lab)((0,e.inRange0to255)(i*this._whitePoint.r),(0,e.inRange0to255)(c*this._whitePoint.g),(0,e.inRange0to255)(_*this._whitePoint.b)),g=(h-r)*this._whitePoint.a*n._kA,R=this.calculateRawInLab(o,l);return Math.sqrt(R+g*g)}calculateRawInLab(a,t){const e=a.L,s=a.a,d=a.b,r=t.L,i=t.a,c=t.b,_=Math.sqrt(s*s+d*d),h=Math.sqrt(i*i+c*c),o=Math.pow((_+h)/2,7),l=.5*(1-Math.sqrt(o/(o+n._pow25to7))),g=(1+l)*s,R=(1+l)*i,u=Math.sqrt(g*g+d*d),M=Math.sqrt(R*R+c*c),I=u*M,p=n._calculatehp(d,g),w=n._calculatehp(c,R),b=Math.abs(p-w),q=r-e,P=M-u,x=n._calculate_dHp(I,b,w,p),v=n._calculate_ahp(I,b,p,w),C=n._calculateT(v),D=(u+M)/2,E=Math.pow((e+r)/2-50,2),L=1+.015*E/Math.sqrt(20+E),T=1+.045*D,A=1+.015*C*D,f=n._calculateRT(v,D),k=q/L,H=P/T,j=x/A;return Math.pow(k,2)+Math.pow(H,2)+Math.pow(j,2)+f*H*j}}exports.CIEDE2000=n,n._kA=25/255,n._pow25to7=Math.pow(25,7),n._deg360InRad=(0,e.degrees2radians)(360),n._deg180InRad=(0,e.degrees2radians)(180),n._deg30InRad=(0,e.degrees2radians)(30),n._deg6InRad=(0,e.degrees2radians)(6),n._deg63InRad=(0,e.degrees2radians)(63),n._deg275InRad=(0,e.degrees2radians)(275),n._deg25InRad=(0,e.degrees2radians)(25);
},{"./distanceCalculator":"rtya","../conversion/rgb2lab":"mK7q","../utils/arithmetic":"b3mL"}],"FZPz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CMetric=void 0;var t=require("./distanceCalculator");class e extends t.AbstractDistanceCalculator{calculateRaw(t,e,i,s,r,a,o,c){const h=(t+r)/2*this._whitePoint.r,n=(t-r)*this._whitePoint.r,l=(e-a)*this._whitePoint.g,u=(i-o)*this._whitePoint.b,_=((512+h)*n*n>>8)+4*l*l+((767-h)*u*u>>8),w=(c-s)*this._whitePoint.a;return Math.sqrt(_+w*w)}_setDefaults(){}}exports.CMetric=e;
},{"./distanceCalculator":"rtya"}],"Nul3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EuclideanBT709NoAlpha=exports.EuclideanBT709=exports.Euclidean=exports.AbstractEuclidean=void 0;var t=require("./distanceCalculator"),s=require("../constants/bt709");class e extends t.AbstractDistanceCalculator{calculateRaw(t,s,e,a,i,c,l,r){const _=i-t,u=c-s,h=l-e,n=r-a;return Math.sqrt(this._kR*_*_+this._kG*u*u+this._kB*h*h+this._kA*n*n)}}exports.AbstractEuclidean=e;class a extends e{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}}exports.Euclidean=a;class i extends e{_setDefaults(){this._kR=s.Y.RED,this._kG=s.Y.GREEN,this._kB=s.Y.BLUE,this._kA=1}}exports.EuclideanBT709=i;class c extends e{_setDefaults(){this._kR=s.Y.RED,this._kG=s.Y.GREEN,this._kB=s.Y.BLUE,this._kA=0}}exports.EuclideanBT709NoAlpha=c;
},{"./distanceCalculator":"rtya","../constants/bt709":"Spxq"}],"rGhK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManhattanBT709=exports.ManhattanNommyde=exports.Manhattan=exports.AbstractManhattan=void 0;var t=require("./distanceCalculator"),s=require("../constants/bt709");class a extends t.AbstractDistanceCalculator{calculateRaw(t,s,a,e,n,h,r,i){let _=n-t,o=h-s,c=r-a,k=i-e;return _<0&&(_=0-_),o<0&&(o=0-o),c<0&&(c=0-c),k<0&&(k=0-k),this._kR*_+this._kG*o+this._kB*c+this._kA*k}}exports.AbstractManhattan=a;class e extends a{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}}exports.Manhattan=e;class n extends a{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}}exports.ManhattanNommyde=n;class h extends a{_setDefaults(){this._kR=s.Y.RED,this._kG=s.Y.GREEN,this._kB=s.Y.BLUE,this._kA=1}}exports.ManhattanBT709=h;
},{"./distanceCalculator":"rtya","../constants/bt709":"Spxq"}],"VUdH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PNGQuant=void 0;var t=require("./distanceCalculator");class e extends t.AbstractDistanceCalculator{calculateRaw(t,e,i,r,s,o,h,n){const c=(n-r)*this._whitePoint.a;return this._colordifferenceCh(t*this._whitePoint.r,s*this._whitePoint.r,c)+this._colordifferenceCh(e*this._whitePoint.g,o*this._whitePoint.g,c)+this._colordifferenceCh(i*this._whitePoint.b,h*this._whitePoint.b,c)}_colordifferenceCh(t,e,i){const r=t-e,s=r+i;return r*r+s*s}_setDefaults(){}}exports.PNGQuant=e;
},{"./distanceCalculator":"rtya"}],"a183":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AbstractDistanceCalculator",{enumerable:!0,get:function(){return e.AbstractDistanceCalculator}}),Object.defineProperty(exports,"CIE94Textiles",{enumerable:!0,get:function(){return t.CIE94Textiles}}),Object.defineProperty(exports,"CIE94GraphicArts",{enumerable:!0,get:function(){return t.CIE94GraphicArts}}),Object.defineProperty(exports,"CIEDE2000",{enumerable:!0,get:function(){return r.CIEDE2000}}),Object.defineProperty(exports,"CMetric",{enumerable:!0,get:function(){return n.CMetric}}),Object.defineProperty(exports,"AbstractEuclidean",{enumerable:!0,get:function(){return a.AbstractEuclidean}}),Object.defineProperty(exports,"Euclidean",{enumerable:!0,get:function(){return a.Euclidean}}),Object.defineProperty(exports,"EuclideanBT709NoAlpha",{enumerable:!0,get:function(){return a.EuclideanBT709NoAlpha}}),Object.defineProperty(exports,"EuclideanBT709",{enumerable:!0,get:function(){return a.EuclideanBT709}}),Object.defineProperty(exports,"AbstractManhattan",{enumerable:!0,get:function(){return u.AbstractManhattan}}),Object.defineProperty(exports,"Manhattan",{enumerable:!0,get:function(){return u.Manhattan}}),Object.defineProperty(exports,"ManhattanBT709",{enumerable:!0,get:function(){return u.ManhattanBT709}}),Object.defineProperty(exports,"ManhattanNommyde",{enumerable:!0,get:function(){return u.ManhattanNommyde}}),Object.defineProperty(exports,"PNGQuant",{enumerable:!0,get:function(){return c.PNGQuant}});var e=require("./distanceCalculator"),t=require("./cie94"),r=require("./ciede2000"),n=require("./cmetric"),a=require("./euclidean"),u=require("./manhattan"),c=require("./pngQuant");
},{"./distanceCalculator":"rtya","./cie94":"MS9V","./ciede2000":"oVGY","./cmetric":"FZPz","./euclidean":"Nul3","./manhattan":"rGhK","./pngQuant":"VUdH"}],"gm7f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractPaletteQuantizer=void 0;class e{quantizeSync(){for(const e of this.quantize())if(e.palette)return e.palette;throw new Error("unreachable")}}exports.AbstractPaletteQuantizer=e;
},{}],"AzZH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Point=void 0;var t=require("../constants/bt709");class i{static createByQuadruplet(t){const s=new i;return s.r=0|t[0],s.g=0|t[1],s.b=0|t[2],s.a=0|t[3],s._loadUINT32(),s._loadQuadruplet(),s}static createByRGBA(t,s,a,r){const h=new i;return h.r=0|t,h.g=0|s,h.b=0|a,h.a=0|r,h._loadUINT32(),h._loadQuadruplet(),h}static createByUint32(t){const s=new i;return s.uint32=t>>>0,s._loadRGBA(),s._loadQuadruplet(),s}constructor(){this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}from(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.uint32=t.uint32,this.rgba[0]=t.r,this.rgba[1]=t.g,this.rgba[2]=t.b,this.rgba[3]=t.a}getLuminosity(i){let s=this.r,a=this.g,r=this.b;return i&&(s=Math.min(255,255-this.a+this.a*s/255),a=Math.min(255,255-this.a+this.a*a/255),r=Math.min(255,255-this.a+this.a*r/255)),s*t.Y.RED+a*t.Y.GREEN+r*t.Y.BLUE}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}}exports.Point=i;
},{"../constants/bt709":"Spxq"}],"zKNk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PointContainer=void 0;var t=require("./point");class r{constructor(){this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(t){this._width=t}setHeight(t){this._height=t}getPointArray(){return this._pointArray}clone(){const e=new r;e._width=this._width,e._height=this._height;for(let r=0,i=this._pointArray.length;r<i;r++)e._pointArray[r]=t.Point.createByUint32(0|this._pointArray[r].uint32);return e}toUint32Array(){const t=this._pointArray.length,r=new Uint32Array(t);for(let e=0;e<t;e++)r[e]=this._pointArray[e].uint32;return r}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(t){const e=t.naturalWidth,i=t.naturalHeight,n=document.createElement("canvas");return n.width=e,n.height=i,n.getContext("2d").drawImage(t,0,0,e,i,0,0,e,i),r.fromHTMLCanvasElement(n)}static fromHTMLCanvasElement(t){const e=t.width,i=t.height,n=t.getContext("2d").getImageData(0,0,e,i);return r.fromImageData(n)}static fromImageData(t){const e=t.width,i=t.height;return r.fromUint8Array(t.data,e,i)}static fromUint8Array(t,e,i){switch(Object.prototype.toString.call(t)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:t=new Uint8Array(t)}const n=new Uint32Array(t.buffer);return r.fromUint32Array(n,e,i)}static fromUint32Array(e,i,n){const a=new r;a._width=i,a._height=n;for(let r=0,o=e.length;r<o;r++)a._pointArray[r]=t.Point.createByUint32(0|e[r]);return a}static fromBuffer(t,e,i){const n=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/Uint32Array.BYTES_PER_ELEMENT);return r.fromUint32Array(n,e,i)}}exports.PointContainer=r;
},{"./point":"AzZH"}],"KCSi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hueGroup=e,exports.Palette=void 0;var t=require("./pointContainer"),r=require("../conversion/rgb2hsl");const i=10;function e(t,r){const i=360/r;for(let e=1,n=i-i/2;e<r;e++,n+=i)if(t>=n&&t<n+i)return e;return 0}class n{constructor(){this._pointArray=[],this._i32idx={},this._pointContainer=new t.PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(t){this._pointArray.push(t),this._pointContainer.setWidth(this._pointArray.length)}has(t){for(let r=this._pointArray.length-1;r>=0;r--)if(t.uint32===this._pointArray[r].uint32)return!0;return!1}getNearestColor(t,r){return this._pointArray[0|this._getNearestIndex(t,r)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(t){return"number"==typeof this._i32idx[t]?this._i32idx[t]:-1}_getNearestIndex(t,r){let i=this._nearestPointFromCache(""+r.uint32);if(i>=0)return i;let e=Number.MAX_VALUE;i=0;for(let n=0,o=this._pointArray.length;n<o;n++){const o=this._pointArray[n],s=t.calculateRaw(r.r,r.g,r.b,r.a,o.r,o.g,o.b,o.a);s<e&&(e=s,i=n)}return this._i32idx[r.uint32]=i,i}sort(){this._i32idx={},this._pointArray.sort((t,n)=>{const o=(0,r.rgb2hsl)(t.r,t.g,t.b),s=(0,r.rgb2hsl)(n.r,n.g,n.b),a=t.r===t.g&&t.g===t.b?0:1+e(o.h,i),h=(n.r===n.g&&n.g===n.b?0:1+e(s.h,i))-a;if(h)return-h;const u=t.getLuminosity(!0),_=n.getLuminosity(!0);if(_-u!=0)return _-u;const p=(100*s.s|0)-(100*o.s|0);return p?-p:0})}}exports.Palette=n;
},{"./pointContainer":"zKNk","../conversion/rgb2hsl":"RhPC"}],"sduU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HueStatistics=void 0;var s=require("../conversion/rgb2hsl"),t=require("./palette");class i{constructor(){this.num=0,this.cols=[]}}class o{constructor(s,t){this._numGroups=s,this._minCols=t,this._stats=[];for(let o=0;o<=s;o++)this._stats[o]=new i;this._groupsFull=0}check(i){this._groupsFull===this._numGroups+1&&(this.check=function(){});const o=255&i,u=i>>>8&255,r=i>>>16&255,h=o===u&&u===r?0:1+(0,t.hueGroup)((0,s.rgb2hsl)(o,u,r).h,this._numGroups),n=this._stats[h],e=this._minCols;n.num++,n.num>e||(n.num===e&&this._groupsFull++,n.num<=e&&this._stats[h].cols.push(i))}injectIntoDictionary(s){for(let t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach(t=>{s[t]?s[t]++:s[t]=1})}injectIntoArray(s){for(let t=0;t<=this._numGroups;t++)this._stats[t].num<=this._minCols&&this._stats[t].cols.forEach(t=>{-1===s.indexOf(t)&&s.push(t)})}}exports.HueStatistics=o;
},{"../conversion/rgb2hsl":"RhPC","./palette":"KCSi"}],"ywMQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProgressTracker=void 0;class s{constructor(t,e){this._range=t,this._progressRange=e,this._step=Math.max(1,this._range/(s.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(s){return s-this._last>=this._step&&(this._last=s,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}}exports.ProgressTracker=s,s.steps=100;
},{}],"MRhM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"HueStatistics",{enumerable:!0,get:function(){return t.HueStatistics}}),Object.defineProperty(exports,"Palette",{enumerable:!0,get:function(){return r.Palette}}),Object.defineProperty(exports,"Point",{enumerable:!0,get:function(){return n.Point}}),Object.defineProperty(exports,"PointContainer",{enumerable:!0,get:function(){return i.PointContainer}}),Object.defineProperty(exports,"ProgressTracker",{enumerable:!0,get:function(){return o.ProgressTracker}}),exports.arithmetic=void 0;var e=a(require("./arithmetic"));exports.arithmetic=e;var t=require("./hueStatistics"),r=require("./palette"),n=require("./point"),i=require("./pointContainer"),o=require("./progressTracker");function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}
},{"./arithmetic":"b3mL","./hueStatistics":"sduU","./palette":"KCSi","./point":"AzZH","./pointContainer":"zKNk","./progressTracker":"ywMQ"}],"TSYH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NeuQuant=void 0;var t=require("../../utils/palette"),i=require("../../utils/point"),e=require("../paletteQuantizer"),s=require("../../utils");const a=3;class r{constructor(t){this.r=this.g=this.b=this.a=t}toPoint(){return i.Point.createByRGBA(this.r>>a,this.g>>a,this.b>>a,this.a>>a)}subtract(t,i,e,s){this.r-=0|t,this.g-=0|i,this.b-=0|e,this.a-=0|s}}class _ extends e.AbstractPaletteQuantizer{constructor(t,i=256){super(),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<a,255<<a,255<<a,255<<a)}sample(t){this._pointArray=this._pointArray.concat(t.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let t=0;t<this._networkSize;t++)this._network[t]=new r((t<<a+8)/this._networkSize|0),this._freq[t]=_._initialBias/this._networkSize|0,this._bias[t]=0}*_learn(){let t=this._sampleFactor;const i=this._pointArray.length;i<_._minpicturebytes&&(t=1);const e=30+(t-1)/3|0,r=i/t|0;let h,n=r/_._nCycles|0,o=_._initAlpha,l=(this._networkSize>>3)*_._radiusBias,c=l>>_._radiusBiasShift;c<=1&&(c=0);for(let s=0;s<c;s++)this._radPower[s]=o*((c*c-s*s)*_._radBias/(c*c))>>>0;h=i<_._minpicturebytes?1:i%_._prime1!=0?_._prime1:i%_._prime2!=0?_._prime2:i%_._prime3!=0?_._prime3:_._prime4;const p=new s.ProgressTracker(r,99);for(let s=0,u=0;s<r;){p.shouldNotify(s)&&(yield{progress:p.progress});const t=this._pointArray[u],r=t.b<<a,f=t.g<<a,d=t.r<<a,b=t.a<<a,S=this._contest(r,f,d,b);if(this._alterSingle(o,S,r,f,d,b),0!==c&&this._alterNeighbour(c,S,r,f,d,b),(u+=h)>=i&&(u-=i),0===n&&(n=1),++s%n==0){o-=o/e|0,(c=(l-=l/_._radiusDecrease|0)>>_._radiusBiasShift)<=1&&(c=0);for(let t=0;t<c;t++)this._radPower[t]=o*((c*c-t*t)*_._radBias/(c*c))>>>0}}}_buildPalette(){const i=new t.Palette;return this._network.forEach(t=>{i.add(t.toPoint())}),i.sort(),i}_alterNeighbour(t,i,e,s,a,r){let h=i-t;h<-1&&(h=-1);let n=i+t;n>this._networkSize&&(n=this._networkSize);let o=i+1,l=i-1,c=1;for(;o<n||l>h;){const t=this._radPower[c++]/_._alphaRadBias;if(o<n){const i=this._network[o++];i.subtract(t*(i.r-a),t*(i.g-s),t*(i.b-e),t*(i.a-r))}if(l>h){const i=this._network[l--];i.subtract(t*(i.r-a),t*(i.g-s),t*(i.b-e),t*(i.a-r))}}}_alterSingle(t,i,e,s,a,r){t/=_._initAlpha;const h=this._network[i];h.subtract(t*(h.r-a),t*(h.g-s),t*(h.b-e),t*(h.a-r))}_contest(t,i,e,s){const r=1020<<a;let h=~(1<<31),n=h,o=-1,l=o;for(let c=0;c<this._networkSize;c++){const p=this._network[c],u=this._distance.calculateNormalized(p,{r:e,g:i,b:t,a:s})*r|0;u<h&&(h=u,o=c);const f=u-(this._bias[c]>>_._initialBiasShift-a);f<n&&(n=f,l=c);const d=this._freq[c]>>_._betaShift;this._freq[c]-=d,this._bias[c]+=d<<_._gammaShift}return this._freq[o]+=_._beta,this._bias[o]-=_._betaGamma,l}}exports.NeuQuant=_,_._prime1=499,_._prime2=491,_._prime3=487,_._prime4=503,_._minpicturebytes=_._prime4,_._nCycles=100,_._initialBiasShift=16,_._initialBias=1<<_._initialBiasShift,_._gammaShift=10,_._betaShift=10,_._beta=_._initialBias>>_._betaShift,_._betaGamma=_._initialBias<<_._gammaShift-_._betaShift,_._radiusBiasShift=6,_._radiusBias=1<<_._radiusBiasShift,_._radiusDecrease=30,_._alphaBiasShift=10,_._initAlpha=1<<_._alphaBiasShift,_._radBiasShift=8,_._radBias=1<<_._radBiasShift,_._alphaRadBiasShift=_._alphaBiasShift+_._radBiasShift,_._alphaRadBias=1<<_._alphaRadBiasShift;
},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],"fT9P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NeuQuantFloat=void 0;var t=require("../../utils/palette"),i=require("../../utils/point"),e=require("../paletteQuantizer"),s=require("../../utils");const a=3;class r{constructor(t){this.r=this.g=this.b=this.a=t}toPoint(){return i.Point.createByRGBA(this.r>>a,this.g>>a,this.b>>a,this.a>>a)}subtract(t,i,e,s){this.r-=t,this.g-=i,this.b-=e,this.a-=s}}class _ extends e.AbstractPaletteQuantizer{constructor(t,i=256){super(),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<a,255<<a,255<<a,255<<a)}sample(t){this._pointArray=this._pointArray.concat(t.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let t=0;t<this._networkSize;t++)this._network[t]=new r((t<<a+8)/this._networkSize),this._freq[t]=_._initialBias/this._networkSize,this._bias[t]=0}*_learn(){let t=this._sampleFactor;const i=this._pointArray.length;i<_._minpicturebytes&&(t=1);const e=30+(t-1)/3,r=i/t;let h,n=r/_._nCycles|0,o=_._initAlpha,l=(this._networkSize>>3)*_._radiusBias,c=l>>_._radiusBiasShift;c<=1&&(c=0);for(let s=0;s<c;s++)this._radPower[s]=o*((c*c-s*s)*_._radBias/(c*c));h=i<_._minpicturebytes?1:i%_._prime1!=0?_._prime1:i%_._prime2!=0?_._prime2:i%_._prime3!=0?_._prime3:_._prime4;const p=new s.ProgressTracker(r,99);for(let s=0,u=0;s<r;){p.shouldNotify(s)&&(yield{progress:p.progress});const t=this._pointArray[u],r=t.b<<a,f=t.g<<a,d=t.r<<a,b=t.a<<a,S=this._contest(r,f,d,b);if(this._alterSingle(o,S,r,f,d,b),0!==c&&this._alterNeighbour(c,S,r,f,d,b),(u+=h)>=i&&(u-=i),0===n&&(n=1),++s%n==0){o-=o/e,(c=(l-=l/_._radiusDecrease)>>_._radiusBiasShift)<=1&&(c=0);for(let t=0;t<c;t++)this._radPower[t]=o*((c*c-t*t)*_._radBias/(c*c))}}}_buildPalette(){const i=new t.Palette;return this._network.forEach(t=>{i.add(t.toPoint())}),i.sort(),i}_alterNeighbour(t,i,e,s,a,r){let h=i-t;h<-1&&(h=-1);let n=i+t;n>this._networkSize&&(n=this._networkSize);let o=i+1,l=i-1,c=1;for(;o<n||l>h;){const t=this._radPower[c++]/_._alphaRadBias;if(o<n){const i=this._network[o++];i.subtract(t*(i.r-a),t*(i.g-s),t*(i.b-e),t*(i.a-r))}if(l>h){const i=this._network[l--];i.subtract(t*(i.r-a),t*(i.g-s),t*(i.b-e),t*(i.a-r))}}}_alterSingle(t,i,e,s,a,r){t/=_._initAlpha;const h=this._network[i];h.subtract(t*(h.r-a),t*(h.g-s),t*(h.b-e),t*(h.a-r))}_contest(t,i,e,s){const r=1020<<a;let h=~(1<<31),n=h,o=-1,l=o;for(let c=0;c<this._networkSize;c++){const p=this._network[c],u=this._distance.calculateNormalized(p,{r:e,g:i,b:t,a:s})*r;u<h&&(h=u,o=c);const f=u-(this._bias[c]>>_._initialBiasShift-a);f<n&&(n=f,l=c);const d=this._freq[c]>>_._betaShift;this._freq[c]-=d,this._bias[c]+=d<<_._gammaShift}return this._freq[o]+=_._beta,this._bias[o]-=_._betaGamma,l}}exports.NeuQuantFloat=_,_._prime1=499,_._prime2=491,_._prime3=487,_._prime4=503,_._minpicturebytes=_._prime4,_._nCycles=100,_._initialBiasShift=16,_._initialBias=1<<_._initialBiasShift,_._gammaShift=10,_._betaShift=10,_._beta=_._initialBias>>_._betaShift,_._betaGamma=_._initialBias<<_._gammaShift-_._betaShift,_._radiusBiasShift=6,_._radiusBias=1<<_._radiusBiasShift,_._radiusDecrease=30,_._alphaBiasShift=10,_._initAlpha=1<<_._alphaBiasShift,_._radBiasShift=8,_._radBias=1<<_._radBiasShift,_._alphaRadBiasShift=_._alphaBiasShift+_._radBiasShift,_._alphaRadBias=1<<_._alphaRadBiasShift;
},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],"OrD7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorHistogram=void 0;var t=require("../../utils/hueStatistics"),s=require("../../utils/arithmetic");class e{constructor(s,o){this._method=s,this._minHueCols=o<<2,this._initColors=o<<2,this._hueStats=new t.HueStatistics(e._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(t){switch(this._method){case 1:this._colorStats1D(t);break;case 2:this._colorStats2D(t)}}getImportanceSortedColorsIDXI32(){const t=(0,s.stableSort)(Object.keys(this._histogram),(t,s)=>this._histogram[s]-this._histogram[t]);if(0===t.length)return[];let e;switch(this._method){case 1:const s=Math.min(t.length,this._initColors),o=t[s-1],i=this._histogram[o];e=t.slice(0,s);let r=s;const h=t.length;for(;r<h&&this._histogram[t[r]]===i;)e.push(t[r++]);this._hueStats.injectIntoArray(e);break;case 2:e=t;break;default:throw new Error("Incorrect method")}return e.map(function(t){return+t})}_colorStats1D(t){const s=this._histogram,e=t.getPointArray(),o=e.length;for(let i=0;i<o;i++){const t=e[i].uint32;this._hueStats.check(t),t in s?s[t]++:s[t]=1}}_colorStats2D(t){const s=t.getWidth(),o=t.getHeight(),i=t.getPointArray(),r=e._boxSize[0],h=e._boxSize[1],a=r*h,c=this._makeBoxes(s,o,r,h),n=this._histogram;c.forEach(t=>{let o=Math.round(t.w*t.h/a)*e._boxPixels;o<2&&(o=2);const r={};this._iterateBox(t,s,t=>{const s=i[t].uint32;this._hueStats.check(s),s in n?n[s]++:s in r?++r[s]>=o&&(n[s]=r[s]):r[s]=1})}),this._hueStats.injectIntoDictionary(n)}_iterateBox(t,s,e){const o=t,i=o.y*s+o.x,r=(o.y+o.h-1)*s+(o.x+o.w-1),h=s-o.w+1;let a=0,c=i;do{e.call(this,c),c+=++a%o.w==0?h:1}while(c<=r)}_makeBoxes(t,s,e,o){const i=t%e,r=s%o,h=t-i,a=s-r,c=[];for(let n=0;n<s;n+=o)for(let s=0;s<t;s+=e)c.push({x:s,y:n,w:s===h?i:e,h:n===a?r:o});return c}}exports.ColorHistogram=e,e._boxSize=[64,64],e._boxPixels=2,e._hueGroups=10;
},{"../../utils/hueStatistics":"sduU","../../utils/arithmetic":"b3mL"}],"vmhr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RGBQuant=void 0;var t=require("../../utils/palette"),e=require("../../utils/point"),i=require("./colorHistogram"),s=require("../paletteQuantizer"),r=require("../../utils/arithmetic"),o=require("../../utils");class n{constructor(t,e,i){this.index=t,this.color=e,this.distance=i}}class l extends s.AbstractPaletteQuantizer{constructor(t,e=256,s=2){super(),this._distance=t,this._colors=e,this._histogram=new i.ColorHistogram(s,e),this._initialDistance=.01,this._distanceIncrement=.005}sample(t){this._histogram.sample(t)}*quantize(){const t=this._histogram.getImportanceSortedColorsIDXI32();if(0===t.length)throw new Error("No colors in image");yield*this._buildPalette(t)}*_buildPalette(i){const s=new t.Palette,l=s.getPointContainer().getPointArray(),a=new Array(i.length);for(let t=0;t<i.length;t++)l.push(e.Point.createByUint32(i[t])),a[t]=1;const c=l.length,h=[];let u=c,d=this._initialDistance;const g=new o.ProgressTracker(u-this._colors,99);for(;u>this._colors;){h.length=0;for(let t=0;t<c;t++){if(g.shouldNotify(c-u)&&(yield{progress:g.progress}),0===a[t])continue;const e=l[t];for(let i=t+1;i<c;i++){if(0===a[i])continue;const t=l[i],s=this._distance.calculateNormalized(e,t);s<d&&(h.push(new n(i,t,s)),a[i]=0,u--)}}d+=u>3*this._colors?this._initialDistance:this._distanceIncrement}if(u<this._colors){(0,r.stableSort)(h,function(t,e){return e.distance-t.distance});let t=0;for(;u<this._colors&&t<h.length;){a[h[t].index]=1,u++,t++}}let _=l.length;for(let t=_-1;t>=0;t--)0===a[t]&&(t!==_-1&&(l[t]=l[_-1]),--_);l.length=_,s.sort(),yield{palette:s,progress:100}}}exports.RGBQuant=l;
},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","./colorHistogram":"OrD7","../paletteQuantizer":"gm7f","../../utils/arithmetic":"b3mL","../../utils":"MRhM"}],"YOKj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WuQuant=exports.WuColorCube=void 0;var i=require("../../utils/palette"),e=require("../../utils/point"),m=require("../paletteQuantizer"),u=require("../../utils");function a(i){const e=[];for(let m=0;m<i;m++)e[m]=0;return e}function s(i,e,m,u){const a=new Array(i);for(let s=0;s<i;s++){a[s]=new Array(e);for(let i=0;i<e;i++){a[s][i]=new Array(m);for(let e=0;e<m;e++){a[s][i][e]=new Array(u);for(let m=0;m<u;m++)a[s][i][e][m]=0}}}return a}function n(i,e,m){const u=new Array(i);for(let a=0;a<i;a++){u[a]=new Array(e);for(let i=0;i<e;i++){u[a][i]=new Array(m);for(let e=0;e<m;e++)u[a][i][e]=0}}return u}function t(i,e,m,u,a){for(let s=0;s<e;s++){i[s]=[];for(let e=0;e<m;e++){i[s][e]=[];for(let m=0;m<u;m++)i[s][e][m]=a}}}function M(i,e,m){for(let u=0;u<e;u++)i[u]=m}class l{}exports.WuColorCube=l;class r extends m.AbstractPaletteQuantizer{constructor(i,e=256,m=5){super(),this._distance=i,this._setQuality(m),this._initialize(e)}sample(i){const e=i.getPointArray();for(let m=0,u=e.length;m<u;m++)this._addColor(e[m]);this._pixels=this._pixels.concat(e)}*quantize(){yield*this._preparePalette();const m=new i.Palette;for(let i=0;i<this._colors;i++)if(this._sums[i]>0){const u=this._sums[i],a=this._reds[i]/u,s=this._greens[i]/u,n=this._blues[i]/u,t=this._alphas[i]/u,M=e.Point.createByRGBA(0|a,0|s,0|n,0|t);m.add(M)}m.sort(),yield{palette:m,progress:100}}*_preparePalette(){yield*this._calculateMoments();let i=0;const e=a(this._colors);for(let a=1;a<this._colors;++a){this._cut(this._cubes[i],this._cubes[a])?(e[i]=this._cubes[i].volume>1?this._calculateVariance(this._cubes[i]):0,e[a]=this._cubes[a].volume>1?this._calculateVariance(this._cubes[a]):0):(e[i]=0,a--),i=0;let m=e[0];for(let u=1;u<=a;++u)e[u]>m&&(m=e[u],i=u);if(m<=0){this._colors=a+1;break}}const m=[],u=[],s=[],n=[];for(let a=0;a<this._colors;++a){const i=r._volume(this._cubes[a],this._weights);i>0?(m[a]=r._volume(this._cubes[a],this._momentsRed)/i|0,u[a]=r._volume(this._cubes[a],this._momentsGreen)/i|0,s[a]=r._volume(this._cubes[a],this._momentsBlue)/i|0,n[a]=r._volume(this._cubes[a],this._momentsAlpha)/i|0):(m[a]=0,u[a]=0,s[a]=0,n[a]=0)}this._reds=a(this._colors+1),this._greens=a(this._colors+1),this._blues=a(this._colors+1),this._alphas=a(this._colors+1),this._sums=a(this._colors+1);for(let a=0,t=this._pixels.length;a<t;a++){const i=this._pixels[a];let e=-1,t=Number.MAX_VALUE;for(let a=0;a<this._colors;a++){const M=m[a],l=u[a],r=s[a],h=n[a],_=this._distance.calculateRaw(M,l,r,h,i.r,i.g,i.b,i.a);_<t&&(t=_,e=a)}this._reds[e]+=i.r,this._greens[e]+=i.g,this._blues[e]+=i.b,this._alphas[e]+=i.a,this._sums[e]++}}_addColor(i){const e=8-this._significantBitsPerChannel,m=1+(i.r>>e),u=1+(i.g>>e),a=1+(i.b>>e),s=1+(i.a>>e);this._weights[s][m][u][a]++,this._momentsRed[s][m][u][a]+=i.r,this._momentsGreen[s][m][u][a]+=i.g,this._momentsBlue[s][m][u][a]+=i.b,this._momentsAlpha[s][m][u][a]+=i.a,this._moments[s][m][u][a]+=this._table[i.r]+this._table[i.g]+this._table[i.b]+this._table[i.a]}*_calculateMoments(){const i=[],e=[],m=[],a=[],s=[],l=[],r=n(this._sideSize,this._sideSize,this._sideSize),h=n(this._sideSize,this._sideSize,this._sideSize),_=n(this._sideSize,this._sideSize,this._sideSize),d=n(this._sideSize,this._sideSize,this._sideSize),x=n(this._sideSize,this._sideSize,this._sideSize),o=n(this._sideSize,this._sideSize,this._sideSize);let p=0;const b=new u.ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let u=1;u<=this._alphaMaxSideIndex;++u){t(r,this._sideSize,this._sideSize,this._sideSize,0),t(h,this._sideSize,this._sideSize,this._sideSize,0),t(_,this._sideSize,this._sideSize,this._sideSize,0),t(d,this._sideSize,this._sideSize,this._sideSize,0),t(x,this._sideSize,this._sideSize,this._sideSize,0),t(o,this._sideSize,this._sideSize,this._sideSize,0);for(let n=1;n<=this._maxSideIndex;++n,++p){b.shouldNotify(p)&&(yield{progress:b.progress}),M(i,this._sideSize,0),M(e,this._sideSize,0),M(m,this._sideSize,0),M(a,this._sideSize,0),M(s,this._sideSize,0),M(l,this._sideSize,0);for(let t=1;t<=this._maxSideIndex;++t){let M=0,p=0,b=0,g=0,c=0,S=0;for(let z=1;z<=this._maxSideIndex;++z)M+=this._weights[u][n][t][z],p+=this._momentsRed[u][n][t][z],b+=this._momentsGreen[u][n][t][z],g+=this._momentsBlue[u][n][t][z],c+=this._momentsAlpha[u][n][t][z],S+=this._moments[u][n][t][z],i[z]+=M,e[z]+=p,m[z]+=b,a[z]+=g,s[z]+=c,l[z]+=S,r[n][t][z]=r[n-1][t][z]+i[z],h[n][t][z]=h[n-1][t][z]+e[z],_[n][t][z]=_[n-1][t][z]+m[z],d[n][t][z]=d[n-1][t][z]+a[z],x[n][t][z]=x[n-1][t][z]+s[z],o[n][t][z]=o[n-1][t][z]+l[z],this._weights[u][n][t][z]=this._weights[u-1][n][t][z]+r[n][t][z],this._momentsRed[u][n][t][z]=this._momentsRed[u-1][n][t][z]+h[n][t][z],this._momentsGreen[u][n][t][z]=this._momentsGreen[u-1][n][t][z]+_[n][t][z],this._momentsBlue[u][n][t][z]=this._momentsBlue[u-1][n][t][z]+d[n][t][z],this._momentsAlpha[u][n][t][z]=this._momentsAlpha[u-1][n][t][z]+x[n][t][z],this._moments[u][n][t][z]=this._moments[u-1][n][t][z]+o[n][t][z]}}}}static _volumeFloat(i,e){return e[i.alphaMaximum][i.redMaximum][i.greenMaximum][i.blueMaximum]-e[i.alphaMaximum][i.redMaximum][i.greenMinimum][i.blueMaximum]-e[i.alphaMaximum][i.redMinimum][i.greenMaximum][i.blueMaximum]+e[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMaximum]-e[i.alphaMinimum][i.redMaximum][i.greenMaximum][i.blueMaximum]+e[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMaximum]+e[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMaximum]-e[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMaximum]-(e[i.alphaMaximum][i.redMaximum][i.greenMaximum][i.blueMinimum]-e[i.alphaMinimum][i.redMaximum][i.greenMaximum][i.blueMinimum]-e[i.alphaMaximum][i.redMaximum][i.greenMinimum][i.blueMinimum]+e[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMinimum]-e[i.alphaMaximum][i.redMinimum][i.greenMaximum][i.blueMinimum]+e[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMinimum]+e[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMinimum]-e[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMinimum])}static _volume(i,e){return 0|r._volumeFloat(i,e)}static _top(i,e,m,u){let a;switch(e){case r._alpha:a=u[m][i.redMaximum][i.greenMaximum][i.blueMaximum]-u[m][i.redMaximum][i.greenMinimum][i.blueMaximum]-u[m][i.redMinimum][i.greenMaximum][i.blueMaximum]+u[m][i.redMinimum][i.greenMinimum][i.blueMaximum]-(u[m][i.redMaximum][i.greenMaximum][i.blueMinimum]-u[m][i.redMaximum][i.greenMinimum][i.blueMinimum]-u[m][i.redMinimum][i.greenMaximum][i.blueMinimum]+u[m][i.redMinimum][i.greenMinimum][i.blueMinimum]);break;case r._red:a=u[i.alphaMaximum][m][i.greenMaximum][i.blueMaximum]-u[i.alphaMaximum][m][i.greenMinimum][i.blueMaximum]-u[i.alphaMinimum][m][i.greenMaximum][i.blueMaximum]+u[i.alphaMinimum][m][i.greenMinimum][i.blueMaximum]-(u[i.alphaMaximum][m][i.greenMaximum][i.blueMinimum]-u[i.alphaMaximum][m][i.greenMinimum][i.blueMinimum]-u[i.alphaMinimum][m][i.greenMaximum][i.blueMinimum]+u[i.alphaMinimum][m][i.greenMinimum][i.blueMinimum]);break;case r._green:a=u[i.alphaMaximum][i.redMaximum][m][i.blueMaximum]-u[i.alphaMaximum][i.redMinimum][m][i.blueMaximum]-u[i.alphaMinimum][i.redMaximum][m][i.blueMaximum]+u[i.alphaMinimum][i.redMinimum][m][i.blueMaximum]-(u[i.alphaMaximum][i.redMaximum][m][i.blueMinimum]-u[i.alphaMaximum][i.redMinimum][m][i.blueMinimum]-u[i.alphaMinimum][i.redMaximum][m][i.blueMinimum]+u[i.alphaMinimum][i.redMinimum][m][i.blueMinimum]);break;case r._blue:a=u[i.alphaMaximum][i.redMaximum][i.greenMaximum][m]-u[i.alphaMaximum][i.redMaximum][i.greenMinimum][m]-u[i.alphaMaximum][i.redMinimum][i.greenMaximum][m]+u[i.alphaMaximum][i.redMinimum][i.greenMinimum][m]-(u[i.alphaMinimum][i.redMaximum][i.greenMaximum][m]-u[i.alphaMinimum][i.redMaximum][i.greenMinimum][m]-u[i.alphaMinimum][i.redMinimum][i.greenMaximum][m]+u[i.alphaMinimum][i.redMinimum][i.greenMinimum][m]);break;default:throw new Error("impossible")}return 0|a}static _bottom(i,e,m){switch(e){case r._alpha:return-m[i.alphaMinimum][i.redMaximum][i.greenMaximum][i.blueMaximum]+m[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMaximum]+m[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMaximum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMaximum]-(-m[i.alphaMinimum][i.redMaximum][i.greenMaximum][i.blueMinimum]+m[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMinimum]+m[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMinimum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMinimum]);case r._red:return-m[i.alphaMaximum][i.redMinimum][i.greenMaximum][i.blueMaximum]+m[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMaximum]+m[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMaximum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMaximum]-(-m[i.alphaMaximum][i.redMinimum][i.greenMaximum][i.blueMinimum]+m[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMinimum]+m[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMinimum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMinimum]);case r._green:return-m[i.alphaMaximum][i.redMaximum][i.greenMinimum][i.blueMaximum]+m[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMaximum]+m[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMaximum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMaximum]-(-m[i.alphaMaximum][i.redMaximum][i.greenMinimum][i.blueMinimum]+m[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMinimum]+m[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMinimum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMinimum]);case r._blue:return-m[i.alphaMaximum][i.redMaximum][i.greenMaximum][i.blueMinimum]+m[i.alphaMaximum][i.redMaximum][i.greenMinimum][i.blueMinimum]+m[i.alphaMaximum][i.redMinimum][i.greenMaximum][i.blueMinimum]-m[i.alphaMaximum][i.redMinimum][i.greenMinimum][i.blueMinimum]-(-m[i.alphaMinimum][i.redMaximum][i.greenMaximum][i.blueMinimum]+m[i.alphaMinimum][i.redMaximum][i.greenMinimum][i.blueMinimum]+m[i.alphaMinimum][i.redMinimum][i.greenMaximum][i.blueMinimum]-m[i.alphaMinimum][i.redMinimum][i.greenMinimum][i.blueMinimum]);default:return 0}}_calculateVariance(i){const e=r._volume(i,this._momentsRed),m=r._volume(i,this._momentsGreen),u=r._volume(i,this._momentsBlue),a=r._volume(i,this._momentsAlpha);return r._volumeFloat(i,this._moments)-(e*e+m*m+u*u+a*a)/r._volume(i,this._weights)}_maximize(i,e,m,u,a,s,n,t,M){const l=0|r._bottom(i,e,this._momentsRed),h=0|r._bottom(i,e,this._momentsGreen),_=0|r._bottom(i,e,this._momentsBlue),d=0|r._bottom(i,e,this._momentsAlpha),x=0|r._bottom(i,e,this._weights);let o=0,p=-1;for(let b=m;b<u;++b){let m=l+r._top(i,e,b,this._momentsRed),u=h+r._top(i,e,b,this._momentsGreen),g=_+r._top(i,e,b,this._momentsBlue),c=d+r._top(i,e,b,this._momentsAlpha),S=x+r._top(i,e,b,this._weights);if(0!==S){let i=m*m+u*u+g*g+c*c,e=i/S;m=a-m,u=s-u,g=n-g,c=t-c,0!==(S=M-S)&&(e+=(i=m*m+u*u+g*g+c*c)/S)>o&&(o=e,p=b)}}return{max:o,position:p}}_cut(i,e){let m;const u=r._volume(i,this._momentsRed),a=r._volume(i,this._momentsGreen),s=r._volume(i,this._momentsBlue),n=r._volume(i,this._momentsAlpha),t=r._volume(i,this._weights),M=this._maximize(i,r._red,i.redMinimum+1,i.redMaximum,u,a,s,n,t),l=this._maximize(i,r._green,i.greenMinimum+1,i.greenMaximum,u,a,s,n,t),h=this._maximize(i,r._blue,i.blueMinimum+1,i.blueMaximum,u,a,s,n,t),_=this._maximize(i,r._alpha,i.alphaMinimum+1,i.alphaMaximum,u,a,s,n,t);if(_.max>=M.max&&_.max>=l.max&&_.max>=h.max){if(m=r._alpha,_.position<0)return!1}else m=M.max>=_.max&&M.max>=l.max&&M.max>=h.max?r._red:l.max>=_.max&&l.max>=M.max&&l.max>=h.max?r._green:r._blue;switch(e.redMaximum=i.redMaximum,e.greenMaximum=i.greenMaximum,e.blueMaximum=i.blueMaximum,e.alphaMaximum=i.alphaMaximum,m){case r._red:e.redMinimum=i.redMaximum=M.position,e.greenMinimum=i.greenMinimum,e.blueMinimum=i.blueMinimum,e.alphaMinimum=i.alphaMinimum;break;case r._green:e.greenMinimum=i.greenMaximum=l.position,e.redMinimum=i.redMinimum,e.blueMinimum=i.blueMinimum,e.alphaMinimum=i.alphaMinimum;break;case r._blue:e.blueMinimum=i.blueMaximum=h.position,e.redMinimum=i.redMinimum,e.greenMinimum=i.greenMinimum,e.alphaMinimum=i.alphaMinimum;break;case r._alpha:e.alphaMinimum=i.alphaMaximum=_.position,e.blueMinimum=i.blueMinimum,e.redMinimum=i.redMinimum,e.greenMinimum=i.greenMinimum}return i.volume=(i.redMaximum-i.redMinimum)*(i.greenMaximum-i.greenMinimum)*(i.blueMaximum-i.blueMinimum)*(i.alphaMaximum-i.alphaMinimum),e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),!0}_initialize(i){this._colors=i,this._cubes=[];for(let e=0;e<i;e++)this._cubes[e]=new l;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let e=0;e<256;++e)this._table[e]=e*e;this._pixels=[]}_setQuality(i=5){this._significantBitsPerChannel=i,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}}exports.WuQuant=r,r._alpha=3,r._red=2,r._green=1,r._blue=0;
},{"../../utils/palette":"KCSi","../../utils/point":"AzZH","../paletteQuantizer":"gm7f","../../utils":"MRhM"}],"usjm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AbstractPaletteQuantizer",{enumerable:!0,get:function(){return e.AbstractPaletteQuantizer}}),Object.defineProperty(exports,"NeuQuant",{enumerable:!0,get:function(){return t.NeuQuant}}),Object.defineProperty(exports,"NeuQuantFloat",{enumerable:!0,get:function(){return r.NeuQuantFloat}}),Object.defineProperty(exports,"RGBQuant",{enumerable:!0,get:function(){return u.RGBQuant}}),Object.defineProperty(exports,"ColorHistogram",{enumerable:!0,get:function(){return n.ColorHistogram}}),Object.defineProperty(exports,"WuQuant",{enumerable:!0,get:function(){return o.WuQuant}}),Object.defineProperty(exports,"WuColorCube",{enumerable:!0,get:function(){return o.WuColorCube}});var e=require("./paletteQuantizer"),t=require("./neuquant/neuquant"),r=require("./neuquant/neuquantFloat"),u=require("./rgbquant/rgbquant"),n=require("./rgbquant/colorHistogram"),o=require("./wu/wuQuant");
},{"./paletteQuantizer":"gm7f","./neuquant/neuquant":"TSYH","./neuquant/neuquantFloat":"fT9P","./rgbquant/rgbquant":"vmhr","./rgbquant/colorHistogram":"OrD7","./wu/wuQuant":"YOKj"}],"pUS7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractImageQuantizer=void 0;class e{quantizeSync(e,t){for(const r of this.quantize(e,t))if(r.pointContainer)return r.pointContainer;throw new Error("unreachable")}}exports.AbstractImageQuantizer=e;
},{}],"cReF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NearestColor=void 0;var e=require("./imageQuantizer"),r=require("../utils/progressTracker");class t extends e.AbstractImageQuantizer{constructor(e){super(),this._distance=e}*quantize(e,t){const s=e.getPointArray(),o=e.getWidth(),i=e.getHeight(),a=new r.ProgressTracker(i,99);for(let r=0;r<i;r++){a.shouldNotify(r)&&(yield{progress:a.progress});for(let e=0,i=r*o;e<o;e++,i++){const e=s[i];e.from(t.getNearestColor(this._distance,e))}}yield{pointContainer:e,progress:100}}}exports.NearestColor=t;
},{"./imageQuantizer":"pUS7","../utils/progressTracker":"ywMQ"}],"KQk7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ErrorDiffusionArray=exports.ErrorDiffusionArrayKernel=void 0;var e,r=require("./imageQuantizer"),t=require("../utils/point"),i=require("../utils/arithmetic"),s=require("../utils/progressTracker");exports.ErrorDiffusionArrayKernel=e,function(e){e[e.FloydSteinberg=0]="FloydSteinberg",e[e.FalseFloydSteinberg=1]="FalseFloydSteinberg",e[e.Stucki=2]="Stucki",e[e.Atkinson=3]="Atkinson",e[e.Jarvis=4]="Jarvis",e[e.Burkes=5]="Burkes",e[e.Sierra=6]="Sierra",e[e.TwoSierra=7]="TwoSierra",e[e.SierraLite=8]="SierraLite"}(e||(exports.ErrorDiffusionArrayKernel=e={}));class n extends r.AbstractImageQuantizer{constructor(e,r,t=!0,i=0,s=!1){super(),this._setKernel(r),this._distance=e,this._minColorDistance=i,this._serpentine=t,this._calculateErrorLikeGIMP=s}*quantize(e,r){const n=e.getPointArray(),o=new t.Point,a=e.getWidth(),l=e.getHeight(),c=[];let h=1,u=1;for(const t of this._kernel){const e=t[2]+1;u<e&&(u=e)}for(let t=0;t<u;t++)this._fillErrorLine(c[t]=[],a);const k=new s.ProgressTracker(l,99);for(let s=0;s<l;s++){k.shouldNotify(s)&&(yield{progress:k.progress}),this._serpentine&&(h*=-1);const e=s*a,u=1===h?0:a-1,f=1===h?a:-1;this._fillErrorLine(c[0],a),c.push(c.shift());const g=c[0];for(let k=u,_=e+u;k!==f;k+=h,_+=h){const e=n[_],u=g[k];o.from(e);const f=t.Point.createByRGBA((0,i.inRange0to255Rounded)(e.r+u[0]),(0,i.inRange0to255Rounded)(e.g+u[1]),(0,i.inRange0to255Rounded)(e.b+u[2]),(0,i.inRange0to255Rounded)(e.a+u[3])),d=r.getNearestColor(this._distance,f);if(e.from(d),this._minColorDistance){if(this._distance.calculateNormalized(e,d)<this._minColorDistance)continue}let b,y,S,p;this._calculateErrorLikeGIMP?(b=f.r-d.r,y=f.g-d.g,S=f.b-d.b,p=f.a-d.a):(b=o.r-d.r,y=o.g-d.g,S=o.b-d.b,p=o.a-d.a);const A=1===h?0:this._kernel.length-1,E=1===h?this._kernel.length:-1;for(let r=A;r!==E;r+=h){const e=this._kernel[r][1]*h,t=this._kernel[r][2];if(e+k>=0&&e+k<a&&t+s>=0&&t+s<l){const i=this._kernel[r][0],s=c[t][e+k];s[0]=s[0]+b*i,s[1]=s[1]+y*i,s[2]=s[2]+S*i,s[3]=s[3]+p*i}}}}yield{pointContainer:e,progress:100}}_fillErrorLine(e,r){e.length>r&&(e.length=r);const t=e.length;for(let i=0;i<t;i++){const r=e[i];r[0]=r[1]=r[2]=r[3]=0}for(let i=t;i<r;i++)e[i]=[0,0,0,0]}_setKernel(r){switch(r){case e.FloydSteinberg:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case e.FalseFloydSteinberg:this._kernel=[[3/8,1,0],[3/8,0,1],[.25,1,1]];break;case e.Stucki:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case e.Atkinson:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case e.Jarvis:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case e.Burkes:this._kernel=[[.25,1,0],[.125,2,0],[2/32,-2,1],[.125,-1,1],[.25,0,1],[.125,1,1],[2/32,2,1]];break;case e.Sierra:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[.125,-1,1],[5/32,0,1],[.125,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case e.TwoSierra:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[.125,-1,1],[3/16,0,1],[.125,1,1],[1/16,2,1]];break;case e.SierraLite:this._kernel=[[.5,1,0],[.25,-1,1],[.25,0,1]];break;default:throw new Error("ErrorDiffusionArray: unknown kernel = "+r)}}}exports.ErrorDiffusionArray=n;
},{"./imageQuantizer":"pUS7","../utils/point":"AzZH","../utils/arithmetic":"b3mL","../utils/progressTracker":"ywMQ"}],"Qgra":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hilbertCurve=l;var e,i=require("../../utils/progressTracker");function*l(l,t,c){const d=Math.max(l,t),s={width:l,height:t,level:Math.floor(Math.log(d)/Math.log(2)+1),callback:c,tracker:new i.ProgressTracker(l*t,99),index:0,x:0,y:0};yield*r(s,e.UP),a(s,e.NONE)}function*r(i,l){if(!(i.level<1)){switch(i.tracker.shouldNotify(i.index)&&(yield{progress:i.tracker.progress}),i.level--,l){case e.LEFT:yield*r(i,e.UP),a(i,e.RIGHT),yield*r(i,e.LEFT),a(i,e.DOWN),yield*r(i,e.LEFT),a(i,e.LEFT),yield*r(i,e.DOWN);break;case e.RIGHT:yield*r(i,e.DOWN),a(i,e.LEFT),yield*r(i,e.RIGHT),a(i,e.UP),yield*r(i,e.RIGHT),a(i,e.RIGHT),yield*r(i,e.UP);break;case e.UP:yield*r(i,e.LEFT),a(i,e.DOWN),yield*r(i,e.UP),a(i,e.RIGHT),yield*r(i,e.UP),a(i,e.UP),yield*r(i,e.RIGHT);break;case e.DOWN:yield*r(i,e.RIGHT),a(i,e.UP),yield*r(i,e.DOWN),a(i,e.LEFT),yield*r(i,e.DOWN),a(i,e.DOWN),yield*r(i,e.LEFT)}i.level++}}function a(i,l){switch(i.x>=0&&i.x<i.width&&i.y>=0&&i.y<i.height&&(i.callback(i.x,i.y),i.index++),l){case e.LEFT:i.x--;break;case e.RIGHT:i.x++;break;case e.UP:i.y--;break;case e.DOWN:i.y++}}!function(e){e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.DOWN=4]="DOWN"}(e||(e={}));
},{"../../utils/progressTracker":"ywMQ"}],"XWAF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ErrorDiffusionRiemersma=void 0;var e=require("./imageQuantizer"),r=require("./spaceFillingCurves/hilbertCurve"),t=require("../utils/point"),i=require("../utils/arithmetic");class s extends e.AbstractImageQuantizer{constructor(e,r=16,t=1){super(),this._distance=e,this._errorQueueSize=r,this._weights=s._createWeights(t,r)}*quantize(e,s){const o=e.getPointArray(),u=e.getWidth(),n=e.getHeight(),a=[];let g=0;for(let r=0;r<this._errorQueueSize;r++)a[r]={r:0,g:0,b:0,a:0};yield*(0,r.hilbertCurve)(u,n,(e,r)=>{const n=o[e+r*u];let h=n.r,c=n.g,l=n.b,d=n.a;for(let t=0;t<this._errorQueueSize;t++){const e=this._weights[t],r=a[(t+g)%this._errorQueueSize];h+=r.r*e,c+=r.g*e,l+=r.b*e,d+=r.a*e}const _=t.Point.createByRGBA((0,i.inRange0to255Rounded)(h),(0,i.inRange0to255Rounded)(c),(0,i.inRange0to255Rounded)(l),(0,i.inRange0to255Rounded)(d)),R=s.getNearestColor(this._distance,_),b=((g=(g+1)%this._errorQueueSize)+this._errorQueueSize-1)%this._errorQueueSize;a[b].r=n.r-R.r,a[b].g=n.g-R.g,a[b].b=n.b-R.b,a[b].a=n.a-R.a,n.from(R)}),yield{pointContainer:e,progress:100}}static _createWeights(e,r){const t=[],i=Math.exp(Math.log(r)/(r-1));for(let s=0,o=1;s<r;s++)t[s]=(o+.5|0)/r*e,o*=i;return t}}exports.ErrorDiffusionRiemersma=s;
},{"./imageQuantizer":"pUS7","./spaceFillingCurves/hilbertCurve":"Qgra","../utils/point":"AzZH","../utils/arithmetic":"b3mL"}],"d99G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AbstractImageQuantizer",{enumerable:!0,get:function(){return e.AbstractImageQuantizer}}),Object.defineProperty(exports,"NearestColor",{enumerable:!0,get:function(){return r.NearestColor}}),Object.defineProperty(exports,"ErrorDiffusionArray",{enumerable:!0,get:function(){return t.ErrorDiffusionArray}}),Object.defineProperty(exports,"ErrorDiffusionArrayKernel",{enumerable:!0,get:function(){return t.ErrorDiffusionArrayKernel}}),Object.defineProperty(exports,"ErrorDiffusionRiemersma",{enumerable:!0,get:function(){return n.ErrorDiffusionRiemersma}});var e=require("./imageQuantizer"),r=require("./nearestColor"),t=require("./array"),n=require("./riemersma");
},{"./imageQuantizer":"pUS7","./nearestColor":"cReF","./array":"KQk7","./riemersma":"XWAF"}],"a6Uv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ssim=n;var t=require("../constants/bt709");const e=.01,o=.03;function n(t,n){if(t.getHeight()!==n.getHeight()||t.getWidth()!==n.getWidth())throw new Error("Images have different sizes!");const s=Math.pow(255*e,2),i=Math.pow(255*o,2);let h=0,c=0;return r(t,n,(t,e,o,n)=>{let r=0,g=0,f=0;for(let s=0;s<t.length;s++)g+=Math.pow(t[s]-o,2),f+=Math.pow(e[s]-n,2),r+=(t[s]-o)*(e[s]-n);const a=t.length-1;g/=a,f/=a;const l=(2*o*n+s)*(2*(r/=a)+i),u=(Math.pow(o,2)+Math.pow(n,2)+s)*(g+f+i);c+=l/u,h++}),c/h}function r(t,e,o){const n=t.getWidth(),r=t.getHeight();for(let h=0;h<r;h+=8)for(let c=0;c<n;c+=8){const g=Math.min(8,n-c),f=Math.min(8,r-h),a=s(t,c,h,g,f),l=s(e,c,h,g,f);o(a,l,i(a),i(l))}}function s(e,o,n,r,s){const i=e.getPointArray(),h=[];let c=0;for(let g=n;g<n+s;g++){const n=g*e.getWidth();for(let e=o;e<o+r;e++){const o=i[n+e];h[c]=o.r*t.Y.RED+o.g*t.Y.GREEN+o.b*t.Y.BLUE,c++}}return h}function i(t){let e=0;for(const o of t)e+=o;return e/t.length}
},{"../constants/bt709":"Spxq"}],"yZRa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ssim",{enumerable:!0,get:function(){return e.ssim}});var e=require("./ssim");
},{"./ssim":"a6Uv"}],"kql1":[function(require,module,exports) {

var e=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e);
},{}],"KVo1":[function(require,module,exports) {
var e=module.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e);
},{}],"SP6V":[function(require,module,exports) {
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};
},{}],"DBsB":[function(require,module,exports) {
var r=require("./_is-object");module.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e};
},{"./_is-object":"SP6V"}],"e5TU":[function(require,module,exports) {
module.exports=function(r){try{return!!r()}catch(t){return!0}};
},{}],"ZJLI":[function(require,module,exports) {
module.exports=!require("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});
},{"./_fails":"e5TU"}],"dDni":[function(require,module,exports) {
var e=require("./_is-object"),r=require("./_global").document,t=e(r)&&e(r.createElement);module.exports=function(e){return t?r.createElement(e):{}};
},{"./_is-object":"SP6V","./_global":"kql1"}],"UUWM":[function(require,module,exports) {
module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return 7!=Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a});
},{"./_descriptors":"ZJLI","./_fails":"e5TU","./_dom-create":"dDni"}],"PUNq":[function(require,module,exports) {
var t=require("./_is-object");module.exports=function(r,e){if(!t(r))return r;var o,n;if(e&&"function"==typeof(o=r.toString)&&!t(n=o.call(r)))return n;if("function"==typeof(o=r.valueOf)&&!t(n=o.call(r)))return n;if(!e&&"function"==typeof(o=r.toString)&&!t(n=o.call(r)))return n;throw TypeError("Can't convert object to primitive value")};
},{"./_is-object":"SP6V"}],"wvco":[function(require,module,exports) {
var e=require("./_an-object"),r=require("./_ie8-dom-define"),t=require("./_to-primitive"),i=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function(o,n,u){if(e(o),n=t(n,!0),e(u),r)try{return i(o,n,u)}catch(c){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(o[n]=u.value),o};
},{"./_an-object":"DBsB","./_ie8-dom-define":"UUWM","./_to-primitive":"PUNq","./_descriptors":"ZJLI"}],"B9EI":[function(require,module,exports) {
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};
},{}],"i5RL":[function(require,module,exports) {
var r=require("./_object-dp"),e=require("./_property-desc");module.exports=require("./_descriptors")?function(t,u,o){return r.f(t,u,e(1,o))}:function(r,e,t){return r[e]=t,r};
},{"./_object-dp":"wvco","./_property-desc":"B9EI","./_descriptors":"ZJLI"}],"nW2g":[function(require,module,exports) {
var r={}.hasOwnProperty;module.exports=function(e,n){return r.call(e,n)};
},{}],"f0sk":[function(require,module,exports) {
var o=0,t=Math.random();module.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++o+t).toString(36))};
},{}],"Nw1e":[function(require,module,exports) {
module.exports=!1;
},{}],"sTGr":[function(require,module,exports) {

var r=require("./_core"),e=require("./_global"),o="__core-js_shared__",i=e[o]||(e[o]={});(module.exports=function(r,e){return i[r]||(i[r]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:require("./_library")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"});
},{"./_core":"KVo1","./_global":"kql1","./_library":"Nw1e"}],"xZwm":[function(require,module,exports) {
module.exports=require("./_shared")("native-function-to-string",Function.toString);
},{"./_shared":"sTGr"}],"l2hW":[function(require,module,exports) {

var e=require("./_global"),r=require("./_hide"),t=require("./_has"),i=require("./_uid")("src"),n=require("./_function-to-string"),o="toString",u=(""+n).split(o);require("./_core").inspectSource=function(e){return n.call(e)},(module.exports=function(n,o,c,l){var s="function"==typeof c;s&&(t(c,"name")||r(c,"name",o)),n[o]!==c&&(s&&(t(c,i)||r(c,i,n[o]?""+n[o]:u.join(String(o)))),n===e?n[o]=c:l?n[o]?n[o]=c:r(n,o,c):(delete n[o],r(n,o,c)))})(Function.prototype,o,function(){return"function"==typeof this&&this[i]||n.call(this)});
},{"./_global":"kql1","./_hide":"i5RL","./_has":"nW2g","./_uid":"f0sk","./_function-to-string":"xZwm","./_core":"KVo1"}],"L6p4":[function(require,module,exports) {
module.exports=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};
},{}],"N9ch":[function(require,module,exports) {
var r=require("./_a-function");module.exports=function(n,t,u){if(r(n),void 0===t)return n;switch(u){case 1:return function(r){return n.call(t,r)};case 2:return function(r,u){return n.call(t,r,u)};case 3:return function(r,u,e){return n.call(t,r,u,e)}}return function(){return n.apply(t,arguments)}};
},{"./_a-function":"L6p4"}],"NjVL":[function(require,module,exports) {

var e=require("./_global"),r=require("./_core"),o=require("./_hide"),i=require("./_redefine"),u=require("./_ctx"),n="prototype",t=function(c,f,l){var q,_,a,d,p=c&t.F,v=c&t.G,F=c&t.S,x=c&t.P,y=c&t.B,B=v?e:F?e[f]||(e[f]={}):(e[f]||{})[n],G=v?r:r[f]||(r[f]={}),P=G[n]||(G[n]={});for(q in v&&(l=f),l)a=((_=!p&&B&&void 0!==B[q])?B:l)[q],d=y&&_?u(a,e):x&&"function"==typeof a?u(Function.call,a):a,B&&i(B,q,a,c&t.U),G[q]!=a&&o(G,q,d),x&&P[q]!=a&&(P[q]=a)};e.core=r,t.F=1,t.G=2,t.S=4,t.P=8,t.B=16,t.W=32,t.U=64,t.R=128,module.exports=t;
},{"./_global":"kql1","./_core":"KVo1","./_hide":"i5RL","./_redefine":"l2hW","./_ctx":"N9ch"}],"TTev":[function(require,module,exports) {
module.exports=function(e,r,l){var a=void 0===l;switch(r.length){case 0:return a?e():e.call(l);case 1:return a?e(r[0]):e.call(l,r[0]);case 2:return a?e(r[0],r[1]):e.call(l,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(l,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(l,r[0],r[1],r[2],r[3])}return e.apply(l,r)};
},{}],"DBa9":[function(require,module,exports) {
var e=require("./_global").document;module.exports=e&&e.documentElement;
},{"./_global":"kql1"}],"viv7":[function(require,module,exports) {
var r={}.toString;module.exports=function(t){return r.call(t).slice(8,-1)};
},{}],"sbFn":[function(require,module,exports) {


var e,t,n,i=require("./_ctx"),o=require("./_invoke"),r=require("./_html"),s=require("./_dom-create"),a=require("./_global"),c=a.process,u=a.setImmediate,p=a.clearImmediate,f=a.MessageChannel,l=a.Dispatch,d=0,m={},h="onreadystatechange",g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},v=function(e){g.call(e.data)};u&&p||(u=function(t){for(var n=[],i=1;arguments.length>i;)n.push(arguments[i++]);return m[++d]=function(){o("function"==typeof t?t:Function(t),n)},e(d),d},p=function(e){delete m[e]},"process"==require("./_cof")(c)?e=function(e){c.nextTick(i(g,e,1))}:l&&l.now?e=function(e){l.now(i(g,e,1))}:f?(n=(t=new f).port2,t.port1.onmessage=v,e=i(n.postMessage,n,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts?(e=function(e){a.postMessage(e+"","*")},a.addEventListener("message",v,!1)):e=h in s("script")?function(e){r.appendChild(s("script"))[h]=function(){r.removeChild(this),g.call(e)}}:function(e){setTimeout(i(g,e,1),0)}),module.exports={set:u,clear:p};
},{"./_ctx":"N9ch","./_invoke":"TTev","./_html":"DBa9","./_dom-create":"dDni","./_global":"kql1","./_cof":"viv7"}],"hg3C":[function(require,module,exports) {
var e=require("./_export"),r=require("./_task");e(e.G+e.B,{setImmediate:r.set,clearImmediate:r.clear});
},{"./_export":"NjVL","./_task":"sbFn"}],"lYxK":[function(require,module,exports) {
require("../modules/web.immediate"),module.exports=require("../modules/_core").setImmediate;
},{"../modules/web.immediate":"hg3C","../modules/_core":"KVo1"}],"oYDs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildPaletteSync=i,exports.buildPalette=u,exports.applyPaletteSync=s,exports.applyPalette=c;var r=o(require("core-js/fn/set-immediate")),e=o(require("./distance")),n=o(require("./image")),t=o(require("./palette"));function a(){if("function"!=typeof WeakMap)return null;var r=new WeakMap;return a=function(){return r},r}function o(r){if(r&&r.__esModule)return r;if(null===r||"object"!=typeof r&&"function"!=typeof r)return{default:r};var e=a();if(e&&e.has(r))return e.get(r);var n={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o)){var i=t?Object.getOwnPropertyDescriptor(r,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=r[o]}return n.default=r,e&&e.set(r,n),n}function i(r,{colorDistanceFormula:e,paletteQuantization:n,colors:t}={}){const a=w(l(e),n,t);return r.forEach(r=>a.sample(r)),a.quantizeSync()}async function u(e,{colorDistanceFormula:n,paletteQuantization:t,colors:a,onProgress:o}={}){return new Promise((i,u)=>{const s=w(l(n),t,a);let c,f;e.forEach(r=>s.sample(r));const y=s.quantize(),p=()=>{try{const n=y.next();n.done?i(c):(n.value.palette&&(c=n.value.palette),o&&o(n.value.progress),f=r(p))}catch(e){clearTimeout(f),u(e)}};f=r(p)})}function s(r,e,{colorDistanceFormula:n,imageQuantization:t}={}){return f(l(n),t).quantizeSync(r,e)}async function c(e,n,{colorDistanceFormula:t,imageQuantization:a,onProgress:o}={}){return new Promise((i,u)=>{let s,c;const w=f(l(t),a).quantize(e,n),y=()=>{try{const n=w.next();n.done?i(s):(n.value.pointContainer&&(s=n.value.pointContainer),o&&o(n.value.progress),c=r(y))}catch(e){clearTimeout(c),u(e)}};c=r(y)})}function l(r="euclidean-bt709"){switch(r){case"cie94-graphic-arts":return new e.CIE94GraphicArts;case"cie94-textiles":return new e.CIE94Textiles;case"ciede2000":return new e.CIEDE2000;case"color-metric":return new e.CMetric;case"euclidean":return new e.Euclidean;case"euclidean-bt709":return new e.EuclideanBT709;case"euclidean-bt709-noalpha":return new e.EuclideanBT709NoAlpha;case"manhattan":return new e.Manhattan;case"manhattan-bt709":return new e.ManhattanBT709;case"manhattan-nommyde":return new e.ManhattanNommyde;case"pngquant":return new e.PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${r}`)}}function f(r,e="floyd-steinberg"){switch(e){case"nearest":return new n.NearestColor(r);case"riemersma":return new n.ErrorDiffusionRiemersma(r);case"floyd-steinberg":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.FloydSteinberg);case"false-floyd-steinberg":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.FalseFloydSteinberg);case"stucki":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.Stucki);case"atkinson":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.Atkinson);case"jarvis":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.Jarvis);case"burkes":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.Burkes);case"sierra":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.Sierra);case"two-sierra":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.TwoSierra);case"sierra-lite":return new n.ErrorDiffusionArray(r,n.ErrorDiffusionArrayKernel.SierraLite);default:throw new Error(`Unknown imageQuantization ${e}`)}}function w(r,e="wuquant",n=256){switch(e){case"neuquant":return new t.NeuQuant(r,n);case"rgbquant":return new t.RGBQuant(r,n);case"wuquant":return new t.WuQuant(r,n);case"neuquant-float":return new t.NeuQuantFloat(r,n);default:throw new Error(`Unknown paletteQuantization ${e}`)}}
},{"core-js/fn/set-immediate":"lYxK","./distance":"a183","./image":"d99G","./palette":"usjm"}],"Eoc4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"buildPalette",{enumerable:!0,get:function(){return u.buildPalette}}),Object.defineProperty(exports,"buildPaletteSync",{enumerable:!0,get:function(){return u.buildPaletteSync}}),Object.defineProperty(exports,"applyPalette",{enumerable:!0,get:function(){return u.applyPalette}}),Object.defineProperty(exports,"applyPaletteSync",{enumerable:!0,get:function(){return u.applyPaletteSync}}),exports.utils=exports.quality=exports.image=exports.palette=exports.distance=exports.conversion=exports.constants=void 0;var e=s(require("./constants"));exports.constants=e;var t=s(require("./conversion"));exports.conversion=t;var r=s(require("./distance"));exports.distance=r;var n=s(require("./palette"));exports.palette=n;var o=s(require("./image"));exports.image=o;var a=s(require("./quality"));exports.quality=a;var i=s(require("./utils"));exports.utils=i;var u=require("./basicAPI");function p(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=p();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}
},{"./constants":"TlpJ","./conversion":"T7GD","./distance":"a183","./palette":"usjm","./image":"d99G","./quality":"yZRa","./utils":"MRhM","./basicAPI":"oYDs"}],"qPOO":[function(require,module,exports) {
"use strict";function t(t,a){for(var e,r,d,n=0,u=0;u<t.data.length;u+=4)n+=(e=t.data[u]/255-a.data[u]/255)*e,n+=(r=t.data[u+1]/255-a.data[u+1]/255)*r,n+=(d=t.data[u+2]/255-a.data[u+2]/255)*d;return n}function a(a,e){return t(a,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=a;
},{}],"PDIj":[function(require,module,exports) {
"use strict";function a(a){if(a.length>0)return"#"+a[Math.floor(Math.random()*a.length)].toString(16).substr(2,6);for(var t="#",n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.brushes=void 0;var t=function(){function t(){}return t.prototype.paint=function(t,n){t.fillStyle=a(n);var h=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,r=Math.random()*t.canvas.width*.03125,o=r;t.beginPath(),t.ellipse(h,i,r,o,0,0,2*Math.PI),t.fill()},t}(),n=function(){function t(){}return t.prototype.paint=function(t,n){t.fillStyle=a(n);var h=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,r=Math.random()*t.canvas.width*.125,o=Math.random()*t.canvas.height*.125,e=Math.random()*Math.PI;t.beginPath(),t.ellipse(h,i,r,o,e,0,2*Math.PI),t.fill()},t}(),h=function(){function t(){}return t.prototype.paint=function(t,n){t.fillStyle=a(n);var h=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,r=Math.random()*t.canvas.width*.25,o=Math.random()*t.canvas.height*.25;t.beginPath(),t.fillRect(h,i,r,o)},t}(),i=function(){function t(){}return t.prototype.paint=function(t,n){t.fillStyle=a(n);var h=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,r=.025*t.canvas.width,o=Math.random()*t.canvas.height*.25,e=Math.random()*Math.PI;t.beginPath(),t.ellipse(h,i,r,o,e,0,2*Math.PI),t.fill()},t}(),r=function(){function t(){}return t.prototype.paint=function(t,n){t.fillStyle=a(n);var h=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,r=0,o=0;Math.random()>.49999999?(r=.025*t.canvas.width,o=Math.random()*t.canvas.height*.25):(o=.025*t.canvas.height,r=Math.random()*t.canvas.width*.25),t.beginPath(),t.fillRect(h,i,r,o)},t}(),o=[new n,new t,new h,new r];exports.brushes=o;
},{}],"B6dB":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,i,e,a){void 0===a&&(a=e),Object.defineProperty(t,a,{enumerable:!0,get:function(){return i[e]}})}:function(t,i,e,a){void 0===a&&(a=e),t[a]=i[e]}),i=this&&this.__setModuleDefault||(Object.create?function(t,i){Object.defineProperty(t,"default",{enumerable:!0,value:i})}:function(t,i){t.default=i}),e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&t(a,e,s);return i(a,e),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var s=e(require("dat.gui")),h=require("image-q"),r=a(require("./comparator")),n=require("./brush"),o={"American Gothic":"https://upload.wikimedia.org/wikipedia/commons/c/cc/Grant_Wood_-_American_Gothic_-_Google_Art_Project.jpg","Mona Lisa":"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/1280px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg","Bedroom In Arles":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Vincent_van_Gogh_-_De_slaapkamer_-_Google_Art_Project.jpg/2560px-Vincent_van_Gogh_-_De_slaapkamer_-_Google_Art_Project.jpg","Persistence of Memory":"https://images2.minutemediacdn.com/image/upload/c_fill,g_auto,h_1248,w_2220/f_auto,q_auto,w_1100/v1554925323/shape/mentalfloss/clocks_1.png","The Shoemaker":"https://uploads6.wikiart.org/images/jacob-lawrence/the-shoemaker-1945(1).jpg","Larry Bird":"https://upload.wikimedia.org/wikipedia/commons/2/2f/Larry_Bird_Lipofsky.jpg"},m=300,g=new Uint32Array(0),u=function(){function t(){this.animationId=-1,this.gui=new s.GUI,this.guiState={brush:0,image:o["American Gothic"],usePalette:!0,alpha0:1,alpha1:1},this.brush=n.brushes[0],this.numStrokesTried=0,this.numStrokesKept=0,this.palette=new Uint32Array(0),this.similarity=Number.MAX_VALUE,this.image1=document.createElement("canvas"),this.imageTemp=document.createElement("canvas"),this.image2=document.createElement("canvas"),this.statsEl=document.createElement("p"),document.body.appendChild(this.image1),document.body.appendChild(this.image2),document.body.appendChild(this.statsEl),this.srcimg=new Image,this.srcimg.setAttribute("crossOrigin",""),this.srcimg.onload=this.start.bind(this),this.srcimg.crossOrigin="",this.srcimg.src=o["American Gothic"],this.sourcePixels=this.image2.getContext("2d").createImageData(this.image2.width,this.image2.height),this.iterate=this.iterate.bind(this),this.setupGui()}return t.prototype.start=function(){var t=this.srcimg.naturalWidth/this.srcimg.naturalHeight,i=m,e=m/t;t>1&&(e=m,i=m*t);var a=i+"px",s=e+"px";this.image1.style.width=a,this.image1.style.height=s,this.image1.width=i,this.image1.height=e,this.imageTemp.style.width=a,this.imageTemp.style.height=s,this.imageTemp.width=i,this.imageTemp.height=e,this.image2.style.width=a,this.image2.style.height=s,this.image2.width=i,this.image2.height=e;var r=this.image2.getContext("2d");r.drawImage(this.srcimg,0,0,this.srcimg.naturalWidth,this.srcimg.naturalHeight,0,0,this.image2.width,this.image2.height),this.sourcePixels=r.getImageData(0,0,this.image2.width,this.image2.height);var n=h.utils.PointContainer.fromUint8Array(this.sourcePixels.data,this.sourcePixels.width,this.sourcePixels.height),o=h.buildPaletteSync([n],{colors:256});this.palette=o.getPointContainer().toUint32Array(),this.restartPainting()},t.prototype.restartPainting=function(){cancelAnimationFrame(this.animationId),this.image1.getContext("2d").clearRect(0,0,this.image1.width,this.image1.height),this.imageTemp.getContext("2d").clearRect(0,0,this.imageTemp.width,this.imageTemp.height),this.numStrokesTried=0,this.numStrokesKept=0,this.similarity=Number.MAX_VALUE,this.iterate()},t.prototype.setupGui=function(){var t=this;this.gui.add(this.guiState,"image",o).name("Image").onChange(function(i){cancelAnimationFrame(t.animationId),t.animationId=-1,t.srcimg.src=i}),this.gui.add(this.guiState,"usePalette").name("Limit Palette"),this.gui.add(this.guiState,"brush",{Round:0,Pointillist:1,Boxy:2,Strips:3}).name("Brush").onChange(function(i){t.brush=n.brushes[i]}),this.gui.add(this.guiState,"alpha0",0,1).name("Opacity Min"),this.gui.add(this.guiState,"alpha1",0,1).name("Opacity Max"),this.gui.add(this,"restartPainting").name("Restart")},t.prototype.brushStroke=function(t,i,e){var a=t.getContext("2d");return a.globalAlpha=Math.random()*Math.abs(this.guiState.alpha1-this.guiState.alpha0)+Math.min(this.guiState.alpha0,this.guiState.alpha1),i.paint(a,e),a.getImageData(0,0,t.width,t.height)},t.prototype.iterate=function(){this.numStrokesTried+=1;var t=this.brushStroke(this.imageTemp,this.brush,this.guiState.usePalette?this.palette:g),i=r.default(t,this.sourcePixels);i<this.similarity?(this.similarity=i,this.image1.getContext("2d").putImageData(t,0,0),this.numStrokesKept+=1):this.imageTemp.getContext("2d").drawImage(this.image1,0,0);this.similarity>.1?(this.updateStats(),this.animationId=requestAnimationFrame(this.iterate)):console.log("THRESHOLD ACHIEVED!!!!!")},t.prototype.updateStats=function(){this.numStrokesTried%100==0&&(this.statsEl.innerText="Brushstrokes: "+this.numStrokesKept+"/"+this.numStrokesTried+"="+this.numStrokesKept/this.numStrokesTried+"\nSimilarity: "+this.similarity)},t}(),d=new u;
},{"dat.gui":"ArXC","image-q":"Eoc4","./comparator":"qPOO","./brush":"PDIj"}]},{},["B6dB"], null)
//# sourceMappingURL=src.9ed9abf8.js.map